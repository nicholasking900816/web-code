(()=>{"use strict";var e,t={6734:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(e){return e[1]}));r.push([e.id,".app{display:flex}.app .code-snippet-container{flex-grow:1;height:100%;position:relative}.app .code-snippet-container .controll-bar-wrapper{position:absolute;top:0;left:0;right:0;height:35px;display:flex;align-items:center;background-color:#3c3c3c}.app .code-snippet-container .snippet-wrapper{position:absolute;top:35px;left:0;right:0;bottom:0}.app .side-bar{position:relative;flex-shrink:0;width:300px;height:100%;background-color:#252526}",""]);const s=r},8671:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(e){return e[1]}));r.push([e.id,'@keyframes twinkle{0%{display:1}100%{opacity:0}}.code-snippet{width:100%;height:100%;overflow:auto;background-color:#1e1e1e;font-family:Consolas,"Courier New",monospace;font-size:18px;line-height:24px;cursor:text;position:relative}.code-snippet::-webkit-scrollbar-thumb{background:#424242;border-left:1px solid rgba(255,255,255,.5);border-right:1px solid rgba(255,255,255,.5)}.code-snippet::-webkit-scrollbar-track{border-left:1px solid rgba(255,255,255,.5);border-right:1px solid rgba(255,255,255,.5)}.code-snippet::-webkit-scrollbar{width:17px}.code-snippet .search-box{position:absolute;display:flex;align-items:center;padding-left:10px;padding-right:10px;box-shadow:0 0 20px 1px #111;right:10px;top:10px;height:40px;background-color:#252526;z-index:10}.code-snippet .search-box .controll-btn{margin-left:10px}.code-snippet .search-box .icon-btn{color:#969685;cursor:pointer;margin-left:10px}.code-snippet .search-box textarea{height:24px;resize:none;border:1px solid #007fd4;outline:none;font-size:14px;font-family:Consolas,"Courier New",monospace;color:#d4d4d4;box-sizing:border-box;width:200px;background-color:#3c3c3c;padding-left:5px;padding-top:3px}.code-snippet .bg-block{position:absolute}.code-snippet .cursor{width:1px;height:24px;background-color:#fff;position:absolute;display:none}.code-snippet .cursor.visible{display:block}.code-snippet .cursor.force-visible{display:block !important}.code-snippet .code-hints{position:absolute;width:250px;max-height:300px;color:#d4dfe6;background-color:#1e1e1e;overflow-y:auto;overflow-x:hidden;border:1px solid #454545;z-index:10}.code-snippet .code-hints ul{width:250px}.code-snippet .code-hints li{height:24px;line-height:24px;padding-left:15px;padding-right:15px;cursor:default}.code-snippet .code-hints li .match-text{color:#1a8bd5}.code-snippet .code-hints li span{font-weight:600}.code-snippet .code-hints li:hover{background-color:#2a2b2c}.code-snippet .code-hints li.focus{background-color:#094771}.code-snippet .code-hints li.focus:hover{background-color:#094771}.code-snippet .code-hints::-webkit-scrollbar{background-color:transparent;width:10px}.code-snippet .code-hints::-webkit-scrollbar-track{background-color:transparent}.code-snippet .code-hints::-webkit-scrollbar-thumb{background-color:#464647}.code-snippet .code-input-box{position:fixed;opacity:0;top:-100px}.code-snippet .row-item{display:flex;align-items:center;position:relative;z-index:5;flex-wrap:nowrap}.code-snippet .row-item.selected-row{z-index:4}.code-snippet .row-item.selected-row:hover{z-index:20}.code-snippet .row-item:hover{z-index:20}.code-snippet .row-item .tap-line{position:absolute;top:0;width:0;bottom:0;border-left:1px solid rgba(133,133,133,.2)}.code-snippet .row-item .line-index{flex-shrink:0}.code-snippet .row-item .line-content{flex-grow:1;position:relative;z-index:10;white-space:nowrap}.code-snippet .row-item .line-content .search-result-div{position:absolute;background-color:#613214}.code-snippet .row-item.selected-row .line-content{border:2px solid #252525;display:flex;align-items:center;box-sizing:border-box;height:24px;position:relative;left:-2px}.code-snippet .row-item.selected-row .line-index{color:#d5d5d5}.code-snippet .line-index{color:#858585;margin-right:30px;text-align:right;width:50px}.code-snippet .code-node{color:#d4d4d4;display:inline-block;height:100%;line-height:24px;position:relative;z-index:10}.code-snippet .unuse-node{opacity:.7}.code-snippet .editting-node{position:relative;display:inline}.code-snippet .code-node-container{position:relative;display:inline-block}.code-snippet .code-node-container .error-msg-block{display:none;z-index:20}.code-snippet .code-node-container:hover .error-msg-block{display:block}.wavy-line-decoration{position:relative}.wavy-line-decoration::before{content:"";position:absolute;bottom:-3px;width:100%;height:.25em;background:linear-gradient(45deg, transparent, transparent 45%, #cf4b2f 45%, #cf4b2f 55%, transparent 55%, transparent 100%),linear-gradient(135deg, transparent, transparent 45%, #cf4b2f 45%, #cf4b2f 55%, transparent 55%, transparent 100%);background-size:.5em .5em;background-repeat:repeat-x,repeat-x}',""]);const s=r},1865:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(e){return e[1]}));r.push([e.id,".error-msg-block{position:absolute;left:0;display:inline;white-space:nowrap;padding:5px 10px;background-color:#252526;border:1px solid #454545;color:#87c7cc}.error-msg-block.up-positioin{bottom:26px}.error-msg-block.down-position{top:26px}",""]);const s=r},3922:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(e){return e[1]}));r.push([e.id,".controll-bar{padding-left:10px;padding-right:10px}",""]);const s=r},7857:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(e){return e[1]}));r.push([e.id,'.direcory-component{padding:10px}.direcory-component .directory-children{padding-left:10px}.direcory-component .icon{margin-right:4px}.direcory-component input.input-file-dir-name{background-color:#3c3c3c;border:1px solid #007fd4;outline:none;height:20px;width:100%;font-family:Consolas,"Courier New",monospace;color:#d4d4d4;padding-left:5px}.direcory-component .directory-name,.direcory-component .file-item{cursor:pointer;height:30px;position:relative}.direcory-component .directory-name:hover .bg-bar,.direcory-component .file-item:hover .bg-bar{background-color:#2a2d2e}.direcory-component .directory-name:hover .bg-bar.selected,.direcory-component .file-item:hover .bg-bar.selected{background-color:#37373d}.direcory-component .directory-name .bg-bar,.direcory-component .file-item .bg-bar{top:0;bottom:0;width:300px;right:-10px;position:absolute}.direcory-component .directory-name .bg-bar.selected,.direcory-component .file-item .bg-bar.selected{background-color:#37373d}.direcory-component .directory-name .content-wrapper,.direcory-component .file-item .content-wrapper{position:absolute;top:0;right:0;bottom:0;left:0;display:flex;align-items:center}.direcory-component .directory-name .icon{color:#c8bdbd}.direcory-component .file-item .icon{color:#519aba}.direcory-component span{color:#c8bdbd;font-size:14px}',""]);const s=r},6783:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(e){return e[1]}));r.push([e.id,".operation-menu.tran-full-screen-cover{position:fixed;top:0;left:0;right:0;bottom:0;background-color:transparent;z-index:100}.operation-menu .menu-container{position:absolute;background-color:#252526;padding-top:10px;padding-bottom:10px;width:300px;box-shadow:0 0 20px 0 rgba(0,0,0,.5)}.operation-menu .menu-container ul li{padding:10px 20px 10px 20px}.operation-menu .menu-container ul li:hover{background-color:#094771;cursor:pointer}.operation-menu .menu-container ul li .short-cut{float:right;font-size:14px;opacity:.5}.operation-menu .menu-container ul li i,.operation-menu .menu-container ul li span{color:#d4d4d4}.operation-menu .menu-container ul li i{margin-right:10px}",""]);const s=r},1566:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(3645),r=i.n(n)()((function(e){return e[1]}));r.push([e.id,'.flex{display:flex}.flex-center{justify-content:center;align-items:center}.flex-v-center{align-items:center}.full-screen{position:fixed;left:0;right:0;bottom:0;top:0}.controll-btn{background:transparent;border:0;color:#969685;padding:5px 10px;border-radius:3px;cursor:pointer}.controll-btn i{margin-right:5px}.controll-btn:hover{background-color:#4c4c4c}.loading-cover{position:absolute;top:0;left:0;bottom:0;right:0;background-color:rgba(0,0,0,.3);display:flex;align-items:center;color:#d4d4d4;justify-content:center}.loading-cover::after{content:"loading..."}.hidden{display:none}ul{list-style:none;padding:0;margin:0}',""]);const s=r},7398:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(3379),r=i.n(n),s=i(6734);r()(s.Z,{insert:"head",singleton:!1});const o=s.Z.locals||{}},2636:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(3379),r=i.n(n),s=i(8671);r()(s.Z,{insert:"head",singleton:!1});const o=s.Z.locals||{}},7019:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(3379),r=i.n(n),s=i(1865);r()(s.Z,{insert:"head",singleton:!1});const o=s.Z.locals||{}},9552:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(3379),r=i.n(n),s=i(3922);r()(s.Z,{insert:"head",singleton:!1});const o=s.Z.locals||{}},8255:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(3379),r=i.n(n),s=i(7857);r()(s.Z,{insert:"head",singleton:!1});const o=s.Z.locals||{}},3079:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(3379),r=i.n(n),s=i(6783);r()(s.Z,{insert:"head",singleton:!1});const o=s.Z.locals||{}},1750:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(3379),r=i.n(n),s=i(1566);r()(s.Z,{insert:"head",singleton:!1});const o=s.Z.locals||{}},6748:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BoundaryNode=void 0;const n=i(1614);t.BoundaryNode=class{constructor(e,t){this.node=e,this.body=t,this.id=n.v4()}}},5337:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CodeRenderNode=void 0;const n=i(1614);t.CodeRenderNode=class{constructor(e,t,i=!1,r=!1,s,o,a){this.text=e,this.style=t,this.err=i,this.warn=r,this.msg=s,this.row=o,this.col=a,this.unuse=!1,this.notDecalredErr=!1,this.editting=!1,this.pointerIndex=null,this.lineEnd=!1,this.identifier=!1,this.checkScope=!1,this.isHead=!1,this.declaration=!1,this.selected=!1,this.searchResult=[],this.displayText=[{text:e,style:{color:null==t?void 0:t.color}}],this.id=n.v4()}}},7338:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CodeRenderNodeUtil=void 0;const n=i(5337),r=i(410);class s{static unlink(e){if(e.isHead)throw"can not unlink head node";let t=e.boundary,i=t.nextBoundary;t.nextNode.id===e.id&&(i.prevNode.id===e.id?(s.boundaryLinkedListUtil.unlinked(t),i.prevNode=t.prevNode):t.nextNode=e.nextNode),i.prevNode.id===e.id&&(i.prevNode=e.prevNode),e.identifier&&s.identifierLinkListUtil.unlinked(e),s.nodeLinkedListUtil.unlinked(e)}static insertNodes(e,t,i,n){let r=s.nodeLinkedListUtil,o=s.identifierLinkListUtil,a=s.boundaryLinkedListUtil,l=r.find(e,(e=>e.identifier),t),d=r.findReversely(t,(e=>e.identifier),e),c=r.findReversely(i,(e=>e.identifier),n),h=r.find(n,(e=>e.identifier),i);r.linkAfter(i,e),r.linkAfter(t,n),c?l?(o.linkAfter(c,l),o.linkAfter(d,h)):o.linkAfter(c,h):l&&o.linkAfter(d,l),r.find(e,(e=>{if(e.boundary.nextNode.id===e.id)return a.linkAfter(i.boundary,e.boundary),!0;e.boundary=i.boundary}),t),r.find(n,(e=>{if(e.boundary.nextNode.id===e.id)return a.linkAfter(t.boundary,e.boundary),e.id===n.id&&(e.boundary.prevNode=t),!0;e.boundary=t.boundary})),e.boundary.nextNode.id===e.id&&(e.boundary.prevNode=i),n.boundary.nextNode.id===n.id&&(n.boundary.prevNode=t)}static cloneNode(e){let t=new n.CodeRenderNode;return Object.assign(t,e),t}static linkNodes(e,t){let i=s.nodeLinkedListUtil,n=s.identifierLinkListUtil,r=s.boundaryLinkedListUtil,o=i.findReversely(e,(e=>e.identifier),t),a=i.find(t,(e=>e.identifier),e);i.linkAfter(e,t),o&&n.linkAfter(o,a),i.find(t,(t=>{if(t.boundary.nextNode.id===t.id)return r.linkAfter(e.boundary,t.boundary),!0;t.boundary=e.boundary})),t.boundary.nextNode.id===t.id&&(t.boundary.prevNode=e)}static unlinkNode(e){if(!e.nextNode)return;let t=e.nextNode,i=(e.prevNode,e.boundary),n=i.nextBoundary;i.nextNode.id===e.id&&(i.nextNode=t),n.prevNode.id===e.id&&(n.nextNode.id===i.nextNode.id?s.boundaryLinkedListUtil.unlinked(n):n.prevNode=t),e.identifier&&s.identifierLinkListUtil.unlinked(e),s.unlink(e)}}t.CodeRenderNodeUtil=s,s.nodeLinkedListUtil=new r.LinkedListUtil("prevNode","nextNode"),s.identifierLinkListUtil=new r.LinkedListUtil("prevIdentifier","nextIdentifier"),s.boundaryLinkedListUtil=new r.LinkedListUtil("prevBoundary","nextBoundary")},524:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RegPosQulifier=t.RegQulifier=t.RegPosEscape=t.RegSpecilCharEscape=t.Color=void 0,t.Color={declarationKeyWord:"rgb(86,156,214)",identifier:"rgb(156,220,254)",classIdentifier:"rgb(78,201,176)",ctor:"rgb(86,156,214)",funIdentifier:"rgb(220,220,170)",comment:"rgb(106,153,62)",valueLiterature:"rgb(86,156,214)",keyWord:"rgb(197,132,177)",str:"rgb(201,136,112)",num:"rgb(181,206,150)",normal:"",const:"rgb(79,193,255)",RegChar:"rgb(209,105,81)",RegQualifier:"rgb(215,186,125)",RegEscapeChar:"rgb(215,186,125)",RegEnwrap:"rgb(206,145,103)",RegPosQulifier:"rgb(220,220,170)",RegBrace:"rgb(215,186,125)"},t.RegSpecilCharEscape="cdDsSfrsStvwWnxu",t.RegPosEscape="bB",t.RegQulifier="*+?",t.RegPosQulifier="^$"},9658:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CodeRenderer=void 0;const n=i(5171),r=i(2490),s=i(7083),o=i(5337),a=i(524),l=i(410),d=i(6748),c=i(3450),h=i(4353);t.CodeRenderer=class{constructor(e,t){this.inputCode=e,this.ast=t,this.pos=0,this.isBeautifyingUnExpect=!1,this.renderingVar=!1,this.boundaryLinkedListUtil=new l.LinkedListUtil("prevBoundary","nextBoundary"),this.identifierLinkedListUtil=new l.LinkedListUtil("prevIdentifier","nextIdentifier"),this.nodeLinkedListUtil=new l.LinkedListUtil("prevNode","nextNode"),this.curBoundary=new d.BoundaryNode,this.rowIndex=1,this.colIndex=0}static stringify(e,t){let i="",n=e;for(;n&&(i+=n.text.replace(/\&nbsp;/g," "),n.lineEnd&&(i+="\r\n"),n.id!==t.id);)n=n.nextNode;return i}render(e){let t=this.ast.topLevelBlock,i=this.curBoundary=new d.BoundaryNode,n=this.currentNode=new o.CodeRenderNode(""),r=this.curIdentifier=n;if(n.identifier=!0,n.isHead=!0,this.currentNode.boundary=this.curBoundary,this.curBoundary.nextNode=this.currentNode,this.curBlock=e||t,this.curScope=function(){return(e?e.scope:t.scope)||new h.Scope},e?this.reRender(t.body,e):this.renderBlock(t),this.pos<this.inputCode.length||this.currentNode===n)if(this.curBoundary===i){let i=this.enter(null,e||t);this.advanceTo(this.inputCode.length+1),i()}else this.advanceTo(this.inputCode.length+1);return this.nodeLinkedListUtil.linkAfter(this.currentNode,n),this.boundaryLinkedListUtil.linkAfter(this.curBoundary,i),i.nextNode=n,i.prevNode=n.prevNode,n.boundary=i,this.identifierLinkedListUtil.linkAfter(this.curIdentifier,r),n}reRender(e,t){let i=this.curBlock,n=this.curScope;this.curBlock=t,this.curScope=function(){return t.scope||new h.Scope},this.renderNodes(e,!0),this.curBlock=i,this.curScope=n}renderBlock(e){if(!e||!e.body.length)return;let t=this.curBlock,i=this.curScope;this.curBlock=e,this.curScope=function(){return e.scope||new h.Scope},this.renderNodes(e.body,!0),this.curBlock=t,this.curScope=i}pushNode(e){this.nodeLinkedListUtil.insertAfter(this.currentNode,e),this.currentNode=e,e.boundary=this.curBoundary,e.block=this.curBlock,e.scope=this.curScope,this.colIndex+=e.text.length}enter(e,t){let i=new d.BoundaryNode(e,t);return this.boundaryLinkedListUtil.linkAfter(this.curBoundary,i),this.nodeLinkedListUtil.linkAfter(this.currentNode,i),this.curBoundary=this.currentNode=i,()=>{this.nodeLinkedListUtil.separate(i)}}renderNodes(e,t=!1,i=!0){e.forEach((s=>{if(!s)return;if(s instanceof n.Block)return this.renderBlock(s);let o;switch(this.advanceTo(s.loc.start),t&&(o=this.enter(s,e)),s.code){case r.NodeCode.MemberExpression:this.renderMemberExpression(s);break;case r.NodeCode.ArrayLiteralExpression:this.renderArrayLiteral(s);break;case r.NodeCode.AssignmentExpression:this.renderAssignExpression(s);break;case r.NodeCode.SwitchCaseStatement:this.renderSwitchCase(s);break;case r.NodeCode.ClassDeclarationStatement:this.renderClassDeclaratioin(s);break;case r.NodeCode.BinaryExpression:this.renderBinary(s);break;case r.NodeCode.IfStatement:this.renderIf(s);break;case r.NodeCode.DoWhileStatement:this.renderDoWhile(s);break;case r.NodeCode.ExportDeclarationStatement:this.renderExport(s);break;case r.NodeCode.ForStatement:this.renderForStatement(s);break;case r.NodeCode.CallExpression:this.renderCall(s);break;case r.NodeCode.FunctionDeclarationStatement:case r.NodeCode.FunctionExpression:this.renderFunctionDeclaration(s);break;case r.NodeCode.IdentifierLiteralExpression:this.renderIdentifier(s,null,!1,i);break;case r.NodeCode.ImportStatement:this.renderImport(s);break;case r.NodeCode.NewExpression:this.renderNewExpression(s);break;case r.NodeCode.NumberLiteralExpression:this.renderNumber(s);break;case r.NodeCode.ObjectLiteralExpression:this.renderObject(s);break;case r.NodeCode.StringLiteralExpression:this.renderString(s);break;case r.NodeCode.SwitchStatement:this.renderSwitch(s);break;case r.NodeCode.TemplateLiteralExpression:this.renderTemplate(s);break;case r.NodeCode.TernaryExpression:this.renderTernary(s);break;case r.NodeCode.TryCathchStatement:this.renderTryCatch(s);break;case r.NodeCode.UnaryExpression:this.renderNodes([s.argument]);break;case r.NodeCode.VariableDeclarationStatement:this.renderVariableDelaration(s);break;case r.NodeCode.WhileStatement:this.renderWhileStatement(s);break;case r.NodeCode.WithStatement:this.renderWithStatement(s);break;case r.NodeCode.RegExpression:this.renderReg(s);break;case r.NodeCode.UnexpectStatement:this.renderUnexpects(s);break;case r.NodeCode.ReturnStatement:this.renderReturnStatement(s);break;case r.NodeCode.ThrowStatement:this.renderThrowStatement(s);break;case r.NodeCode.ParticularLiteralExpression:this.renderParticularLiteralExpression(s);break;case r.NodeCode.TypeOfExpression:this.renderTypeOfExpression(s);break;case r.NodeCode.VoidExpression:this.renderVoidExpression(s);break;case r.NodeCode.BreakStatement:this.renderBreakStatement(s);break;case r.NodeCode.BracketEnwrapedExpressioin:this.renderBracketEnwraped(s);break;case r.NodeCode.ContinueStatement:this.renderContinueStatement(s)}this.renderNodes(s.unexpectedNodes),this.advanceTo(s.loc.end),o&&o()}))}renderTypeOfExpression(e){this.advanceTo(e.loc.start),this.advanceTo(this.pos+6,"typeof",a.Color.declarationKeyWord),this.renderNodes([e.argument])}renderVoidExpression(e){this.advanceTo(e.loc.start+4,"void",a.Color.declarationKeyWord),this.renderNodes([e.argument])}renderParticularLiteralExpression(e){this.advanceTo(e.loc.start),this.pushNode(new o.CodeRenderNode(e.raw,{color:a.Color.declarationKeyWord})),this.pos=e.loc.end}renderThrowStatement(e){this.advanceTo(e.loc.start+5,"throw",a.Color.keyWord),this.renderNodes([e.argument])}renderReturnStatement(e){this.advanceTo(e.loc.start+6,"return",a.Color.keyWord),this.renderNodes([e.argument])}renderBracketEnwraped(e){this.renderNodes([e.expression])}renderBreakStatement(e){this.advanceTo(e.loc.start+5,"break",a.Color.keyWord),this.renderNodes([e.argument])}renderContinueStatement(e){this.advanceTo(e.loc.start+8,"continue",a.Color.keyWord),this.renderNodes([e.argument])}renderUnexpects(e){if(!e.value)return;let t=this.isBeautifyingUnExpect,i=this.unexpectMsg;this.isBeautifyingUnExpect=!0,this.unexpectMsg=e.msg,e.value instanceof s.AstNode?(this.renderNodes([e.value]),this.advanceTo(e.loc.end)):(this.advanceTo(e.loc.start),this.pushNode(new o.CodeRenderNode(e.value,{color:a.Color.normal},!0,!1,e.msg)),this.pos=e.loc.end),this.isBeautifyingUnExpect=t,this.unexpectMsg=i}renderReg(e){this.advanceTo(e.loc.start);let t=e.pattern;if(!t)return;this.pushNode(new o.CodeRenderNode("/",{color:a.Color.RegChar}));let i=1,n=1,r=t.length,s=()=>{for(this.pushNode(new o.CodeRenderNode("[",{color:a.Color.RegEnwrap})),n=++i;i<r;){let e=t.charCodeAt(i);if(93===e){l(),this.pushNode(new o.CodeRenderNode("]",{color:a.Color.RegEnwrap})),n=++i;break}92===e?(l(),d()):i++}},l=()=>{let e=t.slice(n,i);e&&this.pushNode(new o.CodeRenderNode(e,{color:a.Color.RegChar})),n=i},d=()=>{let e,r,s=t.charAt(i+1);if("u"===s&&/\\u[a-fA-F0-9]{4}/.test(r=t.slice(i,i+6)))return this.pushNode(new o.CodeRenderNode(r,{color:a.Color.declarationKeyWord})),void(i=n=i+6);e=a.RegSpecilCharEscape.includes(s)?a.Color.RegChar:a.RegPosEscape.includes(s)?a.Color.RegPosQulifier:a.Color.RegEscapeChar,this.pushNode(new o.CodeRenderNode(t.slice(i,n=i+2),{color:e})),i=n},c=()=>{let e=t.slice(i),r=e.indexOf("}");if(r<0)return!1;let s=e.slice(0,r+1);return/{[0-9]+,?[0-9]*}/.test(s)?(this.pushNode(new o.CodeRenderNode(s,{color:a.Color.RegBrace})),i=n=i+s.length,!0):void 0};for(;r>i;){let e=t.charCodeAt(i),r=t.charAt(i);if(92===e)l(),d();else if(91===e)l(),s();else if(123===e)l(),c();else if(40===e||41===e){if(l(),this.pushNode(new o.CodeRenderNode(r,{color:a.Color.RegEnwrap})),40===e){let e=t.slice(i+1,i+3);"?:"===e&&(this.pushNode(new o.CodeRenderNode(e,{color:a.Color.RegEnwrap})),i+=2)}n=++i}else a.RegQulifier.includes(r)?(l(),this.pushNode(new o.CodeRenderNode(r,{color:a.Color.RegQualifier})),n=++i):a.RegPosQulifier.includes(r)?(l(),this.pushNode(new o.CodeRenderNode(r,{color:a.Color.RegPosQulifier})),n=++i):i++}l(),e.flag&&this.pushNode(new o.CodeRenderNode(e.flag,{color:a.Color.declarationKeyWord})),this.pos=e.loc.end}renderWithStatement(e){this.advanceTo(e.loc.start+4,"with",a.Color.keyWord),this.renderNodes([e.context]),this.renderBlock(e.body)}renderTryCatch(e){if(this.advanceTo(e.loc.start+3,"try",a.Color.keyWord),this.renderBlock(e.body),e.catchHandler){let t=e.catchHandler;this.advanceTo(t.loc.start+5,"catch",a.Color.keyWord),t.params.forEach((e=>this.advanceTo(e.loc.start+e.identifier.length,e.identifier,a.Color.identifier))),this.renderBlock(t.body)}e.finalizer&&(e.finalizer.body[0]?(this.advanceTo(e.finalizer.loc.start,"finally",a.Color.keyWord),this.renderBlock(e.finalizer)):this.advanceTo(e.loc.end,"finally",a.Color.keyWord))}renderWhileStatement(e){this.advanceTo(e.loc.start+5,"while",a.Color.keyWord),this.renderNodes([e.test]),this.renderBlock(e.consequence)}renderTernary(e){this.renderNodes([e.test,e.consequent,e.alternate])}renderTemplate(e){this.advanceTo(e.loc.start),e.content.length&&(this.advanceTo(e.content[0].loc.start,null,a.Color.str),this.renderNodes(e.content)),e.unexpectedNodes.length||this.advanceTo(e.loc.end,null,a.Color.str)}renderSwitch(e){this.safeAdvanceToNextStart(e.discriminant,e,"switch",a.Color.keyWord),this.renderNodes([e.discriminant]),e.cases.forEach((e=>this.renderSwitchCase(e)))}renderObject(e){e.properties.forEach((e=>{this.renderNodes([e.key],!1,!1),this.renderNodes([e.value])}))}renderNumber(e){this.advanceTo(e.loc.start),this.pushNode(new o.CodeRenderNode(e.value,{color:a.Color.num},this.isBeautifyingUnExpect,!1,this.unexpectMsg)),this.pos=e.loc.end}renderNewExpression(e){this.safeAdvanceToNextStart(e.callee,e,"new",a.Color.declarationKeyWord),this.renderNodes([e.callee])}renderImport(e){e.imported?(this.advanceTo(e.imported.loc.start,"import",a.Color.keyWord),this.renderIdentifier(e.imported,null,!1,!1),e.local&&this.renderIdentifier(e.local,null,!1,!1)):e.specifiers&&e.specifiers.length&&(this.advanceTo(e.specifiers[0].imported.loc.start,"import",a.Color.keyWord),e.specifiers.forEach((e=>{this.renderIdentifier(e.imported,null,!1,!1),e.local&&this.renderIdentifier(e.local,null,!1,!1)}))),e.from&&this.renderString(e.from)}renderCall(e){this.renderCallee(e.callee),this.renderNodes(e.arguments)}renderCallee(e){if(e.code===r.NodeCode.IdentifierLiteralExpression){let t=this.curScope().getDefinition(e.identifier);this.renderIdentifier(e,t&&t.definitionType===c.DefinitionType.CLASS?a.Color.classIdentifier:a.Color.funIdentifier)}else e.code===r.NodeCode.MemberExpression?this.renderMemberExpression(e,!0):this.renderNodes([e])}renderForStatement(e){this.advanceTo(e.loc.start+3,"for",a.Color.keyWord);let t=this.curScope;e.body&&e.body.scope&&(this.curScope=function(){var t,i;return(null===(i=null===(t=e.body)||void 0===t?void 0:t.scope)||void 0===i?void 0:i.parent)||new h.Scope}),(e.forIn||e.forOf)&&(this.renderNodes([e.left]),this.advanceTo(e.right.loc.start,"((of)|(in))",a.Color.declarationKeyWord),this.renderNodes([e.right]));let i=e.update||[];this.renderNodes([e.init,e.test,...i]),this.renderBlock(e.body),this.curScope=t}renderVariableDelaration(e){this.renderingVar=!0,this.advanceTo(e.loc.start+e.declarationKeyWord.length,e.declarationKeyWord,a.Color.declarationKeyWord),this.renderNodes(e.declarations),this.renderingVar=!1}renderExport(e){e.declaration?(this.advanceTo(e.declaration.loc.start,"export",a.Color.keyWord),this.renderVariableDelaration(e.declaration)):e.exported?(this.advanceTo(e.exported.loc.start,"export",a.Color.keyWord),this.renderNodes([e.exported]),e.local&&this.renderNodes([e.local])):e.specifiers&&(this.advanceTo(e.specifiers[0].exported.loc.start,"export",a.Color.keyWord),e.specifiers.forEach((e=>{this.renderNodes([e.exported]),e.local&&this.renderNodes([e.local])}))),e.from&&this.renderString(e.from)}renderString(e){e&&(this.advanceTo(e.loc.start),this.consumeTo(e.loc.end,a.Color.str))}renderDoWhile(e){this.advanceTo(e.loc.start+2,"do",a.Color.keyWord),this.renderBlock(e.body),e.test&&this.advanceTo(e.test.loc.start,"while",a.Color.keyWord),this.renderNodes([e.test])}renderIf(e){this.safeAdvanceToNextStart(e.test,e,"if",a.Color.keyWord),this.renderNodes([e.test]),this.renderBlock(e.consequent);let t=e.alternate;for(;t;)t.code===r.NodeCode.IfStatement?(this.safeAdvanceToNextStart(t.test,t,"else\\s+if",a.Color.keyWord),this.renderNodes([t.test]),this.renderBlock(t.consequent)):t.body.length?(this.advanceTo(t.loc.start,"else",a.Color.keyWord),this.renderBlock(t)):this.advanceTo(e.loc.end,"else",a.Color.keyWord),t=t.alternate}renderBinary(e){"instanceof"===e.operator||"in"===e.operator?(this.renderNodes([e.left]),this.advanceTo(e.right.loc.start,e.operator,a.Color.declarationKeyWord),this.renderNodes([e.right])):this.renderNodes([e.left,e.right])}renderClassDeclaratioin(e){this.advanceTo(e.loc.start+5,"class",a.Color.declarationKeyWord),this.renderIdentifier(e.className,a.Color.classIdentifier,!1),e.super&&(this.advanceTo(e.super.loc.start,"extends",a.Color.declarationKeyWord),this.renderIdentifier(e.super,a.Color.classIdentifier)),e.methods.forEach((e=>this.renderMethod(e)))}renderMethod(e){"constructor"===e.identifier.identifier?this.renderIdentifier(e.identifier,a.Color.declarationKeyWord,!1,!1):this.renderIdentifier(e.identifier,a.Color.funIdentifier,!1,!1),this.renderNodes(e.params),this.renderBlock(e.body)}renderFunctionDeclaration(e){this.advanceTo(e.loc.start+8,"function",a.Color.declarationKeyWord),e.identifier&&this.renderIdentifier(e.identifier,a.Color.funIdentifier,!1);let t=this.curScope;this.curScope=function(){var t,i;return(null===(i=null===(t=e.body)||void 0===t?void 0:t.scope)||void 0===i?void 0:i.parent)||new h.Scope},this.renderNodes(e.params,!1,!0),this.renderBlock(e.body),this.curScope=t}renderIdentifier(e,t,i=!1,n=!0){if(!e)return;let r;this.advanceTo(e.loc.start),!t&&(r=this.curScope().getDefinition(e.identifier))&&(r.definitionType===c.DefinitionType.CONST?t=a.Color.const:r.type===c.DefinitionType.FUNCTION?t=a.Color.funIdentifier:r.type===c.DefinitionType.CLASS&&(t=a.Color.classIdentifier));let s=new o.CodeRenderNode(e.identifier,t?{color:t}:{color:a.Color.identifier},this.isBeautifyingUnExpect,!1,this.unexpectMsg);s.checkScope=n,s.identifier=!0,s.declaration=i,this.identifierLinkedListUtil.linkAfter(this.curIdentifier,s),this.curIdentifier=s,this.pushNode(s),this.pos+=e.identifier.length}static checkScope(e){if(e.scope){let t=e.scope,i=t().getDefinition(e.text);e.err||e.warn||e.declaration||i||(e.notDecalredErr=!0,e.err=!0,e.msg=`变量 '${e.text}' 未被声明`),i&&(e.unuse=t().isUnuse(i),e.notDecalredErr&&(e.notDecalredErr=e.err=!1,e.msg=null))}}renderSwitchCase(e){e.isDefault?e.consequent.body.length?(this.advanceTo(e.consequent.loc.start,"default",a.Color.keyWord),this.renderBlock(e.consequent)):this.advanceTo(e.loc.end,"default",a.Color.keyWord):(this.safeAdvanceToNextStart(e.test,e,"case",a.Color.keyWord),this.renderNodes([e.test]),this.renderBlock(e.consequent))}renderAssignExpression(e){this.advanceTo(e.loc.start),this.renderingVar?(this.renderNodes([e.left],!1),this.renderingVar=!1,this.renderNodes([e.right]),this.renderingVar=!0):this.renderNodes([e.left,e.right])}renderArrayLiteral(e){this.advanceTo(e.loc.start),this.renderNodes(e.items)}renderMemberExpression(e,t=!1){this.advanceTo(e.loc.start),e.property&&e.property.code===r.NodeCode.IdentifierLiteralExpression?(e.owner.code===r.NodeCode.IdentifierLiteralExpression&&"this"===e.owner.identifier?this.renderIdentifier(e.owner,a.Color.declarationKeyWord,!1,!1):this.renderNodes([e.owner]),this.renderIdentifier(e.property,t?a.Color.funIdentifier:a.Color.identifier,!1,e.isComputed)):this.renderNodes([e.owner,e.property])}advanceTo(e,t,i){if(this.pos===e)return;let n,r=this.inputCode.slice(this.pos,e),s=t?new RegExp(`(\\/\\/)|(\\/\\*)|(\\b${t}\\b)`):/(\/\/)|(\/\*)/,o=t?new RegExp(`\\b${t}\\b`):null;for(;n=s.exec(r);){if(this.consumeTo(this.pos+n.index),r=r.slice(n.index),"//"===n[0]){let t=/\r\n/.exec(r);this.consumeTo(t?this.pos+t.index:e,a.Color.comment)}else if("/*"===n[0]){let e=/\*\//.exec(r);this.consumeTo(this.pos+e.index+2,a.Color.comment)}else o&&o.test(n[0])&&this.consumeTo(this.pos+n[0].length,i);r=this.inputCode.slice(this.pos,e)}this.consumeTo(e)}replaceWhileSpace(e){return e.replace(/\s/g,"&nbsp;")}consumeTo(e,t){if(e===this.pos)return;let i=this.inputCode.slice(this.pos,e).split("\r\n");i.length&&(this.pushNode(new o.CodeRenderNode(i.shift(),t?{color:t}:{},this.isBeautifyingUnExpect,!1,this.unexpectMsg)),i.forEach(((n,r)=>{this.currentNode.lineEnd=!0,this.rowIndex++,this.colIndex=0,!n.length&&r===i.length-1&&e<this.inputCode.length||this.pushNode(new o.CodeRenderNode(n,t?{color:t}:{},this.isBeautifyingUnExpect,!1,this.unexpectMsg,this.rowIndex,this.colIndex))})),this.pos=e)}safeAdvanceToNextStart(e,t,i,n){e?this.advanceTo(e.loc.start,i,n):t.unexpectedNodes.length?this.advanceTo(t.unexpectedNodes[0].loc.start,i,n):this.advanceTo(this.inputCode.length,i,n)}}},410:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedListUtil=void 0,t.LinkedListUtil=class{constructor(e,t){this.prevKey=e,this.nextKey=t}linkBefore(e,t){t[this.nextKey]=e,e[this.prevKey]=t}linkAfter(e,t){e[this.nextKey]=t,t[this.prevKey]=e}insertBefore(e,t){let i=e[this.prevKey];i&&(i[this.nextKey]=t,t[this.prevKey]=i),t[this.nextKey]=e,e[this.prevKey]=t}insertAfter(e,t){let i=e[this.nextKey];i&&(i[this.prevKey]=t,t[this.nextKey]=i),e[this.nextKey]=t,t[this.prevKey]=e}reInsert(e){this.linkAfter(e[this.prevKey],e),this.linkAfter(e,e[this.nextKey])}unlinked(e){let t=e[this.prevKey],i=e[this.nextKey];t&&(t[this.nextKey]=i),i&&(i[this.prevKey]=t),e[this.nextKey]=e[this.prevKey]=null}separate(e){let t=e[this.prevKey],i=e[this.nextKey];t&&(t[this.nextKey]=i),i&&(i[this.prevKey]=t)}forEach(e,t,i){let n=e;do{if(t(n),n===i)break;n=n[this.nextKey]}while(n&&n!==e)}forEachReversely(e,t,i){let n=e;do{if(t(n),n===i)break;n=n[this.prevKey]}while(n&&n!==e)}find(e,t,i){let n=e;do{if(t(n))return n;if(n===i)break;n=n[this.nextKey]}while(n&&n!==e);return null}replace(e,t){this.linkAfter(t[this.prevKey],e),this.linkAfter(e,t[this.nextKey])}findReversely(e,t,i){let n=e;do{if(t(n))return n;if(n===i)break;n=n[this.prevKey]}while(n&&n!==e);return null}length(e){let t=0;return this.forEach(e,(()=>t++)),t}}},3253:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryOperation=void 0;const n=i(7338);t.HistoryOperation=class{constructor(){}mergePrevAstNodes(e){let t=this.index,i=Math.max(this.index+this.prevAstNodes.length-1,e.index+e.prevAstNodes.length-1),n=this.prevAstNodes,r=e.prevAstNodes,s=[];for(let o=t;o<=i;o++)n[o-this.index]||r[o-e.index],s.push(n[o-this.index]||r[o-e.index]);this.prevAstNodes=s,this.index=t}mergeCurrentAstNodes(e){let t=this.index,i=Math.max(this.index+this.currentAstNodes.length-1,e.index+e.currentAstNodes.length-1),n=this.currentAstNodes,r=e.currentAstNodes,s=[];for(let o=t;o<=i;o++)n[o-this.index]||r[o-e.index],s.push(n[o-this.index]||r[o-e.index]);this.currentAstNodes=s}cancelEdit(){n.CodeRenderNodeUtil.insertNodes(this.hisRenderNodeHead,this.hisRenderNodeTail,this.hisRenderNodeHead.prevNode,this.hisRenderNodeTail.nextNode),"number"==typeof this.index&&this.block.body.splice(this.index,this.currentAstNodes.length,...this.prevAstNodes)}mergeEdit(e){this.index=Math.min(this.index,e.index),this.mergeCurrentAstNodes(e),this.mergePrevAstNodes(e)}}},5171:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Block=void 0,t.Block=class{constructor(){this.body=[],this.functionBlock=!1}}},445:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JavascriptAst=void 0;const n=i(5171);t.JavascriptAst=class{constructor(){this.topLevelBlock=new n.Block}}},3134:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JavascriptAstParsser=void 0;const n=i(445),r=i(2490),s=i(9889),o=i(9261),a=i(5194),l=i(5197),d=i(482),c=i(2050),h=i(7217),p=i(1920),u=i(2840),f=i(2995),x=i(9842),m=i(718),y=i(9778),g=i(5171),N=i(9085),C=i(1482),S=i(5425),E=i(7289),b=i(1404),k=i(4246),v=i(3993),w=i(1498),L=i(4014),T=i(7536),I=i(3061),P=i(8266),R=i(7817),D=i(3309),U=i(6010),A=i(5705),M=i(2759),O=i(2662),_=i(1885),B=i(8376),F=i(9475),z=i(4495),W=i(550),j=i(972),V=i(294),K=i(1538),G=i(6290),H=i(8964);class ${constructor(e){this.input=e,this.pos=0,this.currentToken={},this.excutionFlag=0,this.startTokens=[],this.tokens=[],this.currentLine=1,this.isParsingFunDeclaration=!1,this.isParsingLoop=!1,this.depth=1,this.isParsingVarDeclaration=!1}get curCharCode(){return this.input.charCodeAt(this.pos)}get nextCharCode(){return this.input.charCodeAt(this.pos+1)}get curChar(){return this.input.charAt(this.pos)}parse(e=!0){this.ast=new n.JavascriptAst;let t=this.ast.topLevelBlock;for(this.ast.topLevelBlock.depth=this.depth;!this.isReadAll();){let e=this.parseNode();if(e)e.isUnexpectEnd&&(e=new a.UnExpectStatement(e,"unexpect end value"));else if("{"===this.currentToken.value){const t=this.markPos();e=this.parseObjLiteralExp(),e.code===r.NodeCode.ObjectLiteralExpression&&!e.properties.length&&e.unexpectedNodes.length&&(t(),e=this.parseBlock())}else"["===this.currentToken.value&&(e=this.parseArrExp());e&&t.body.push(e)}return e&&(new j.JavascriptScopeAnalyzer).analyze(this.ast.topLevelBlock),this.ast}isReadAll(){return this.pos>this.input.length-1}isLineEnd(){let e=this.pos,t=this.currentLine;this.skipSpace();let i=this.currentLine>t||this.isReadAll();return this.pos=e,this.currentLine=t,i}advance(e){this.pos=this.pos+(e||1)}markPos(){let e=this.pos,t=this.currentToken,i=this.tokens.length,n=this.startTokens.slice();return()=>{this.pos=e,this.currentToken=t,this.tokens.length=i,this.startTokens=n}}skipSpace(){e:for(;!this.isReadAll();){let e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:this.pos++,this.currentLine++;break;case 47:if(47===this.nextCharCode){this.pos++,this.skipLineComment();break}if(42===this.nextCharCode){this.pos++,this.skipBlockComment();break}break e;default:if(!(e>8&&e<14))break e;++this.pos}}}consumeNextWordIfMatch(e){let t=this.markPos();return this.next(),this.currentToken.value===e||(t(),!1)}isNextWordIs(e){let t=this.markPos();return this.next(),this.currentToken.value===e?(t(),!0):(t(),!1)}startParse(e,t){let i=this.parsingNode,n=this.isParsingLoop,s=this.isParsingFunDeclaration;return this.parsingNode=e,t&&(this.excutionFlag|=t),(o=!0)=>(o&&!i&&this.expectExpressionEnd(),e.loc.end=this.pos,this.parsingNode.code===r.NodeCode.FunctionDeclarationStatement?this.isParsingFunDeclaration=!1:(r.NodeCode.Loop&this.parsingNode.code)===this.parsingNode.code&&(this.isParsingLoop=!1),this.parsingNode=i,this.isParsingLoop=n,this.isParsingFunDeclaration=s,t&&(this.excutionFlag&=~t),e.isUnexpectEnd&&this.parsingNode&&(this.parsingNode.isUnexpectEnd=!0),e)}expectToken(e){if(this.isReadAll())return this.parsingNode.isUnexpectEnd=!0,!1;e="string"==typeof e?[e]:e;for(let t of e)if(this.next(),this.currentToken.value!==t)return this.parsingNode.unexpectedNodes.push(new a.UnExpectStatement(this.currentToken.value,`expect ${t}`,this.currentToken.loc)),!1;return!0}expectExpressionEnd(){this.isReadAll()||this.isLineEnd()||this.expectToken(";")}parseNode(e={}){if(this.isReadAll())return null;let t;switch(this.next(),this.currentToken.type){case"Keyword":return this.parseIsStartWithKeyword();case"ParticularLiteral":return new M.ParticularLiteralExpression(this.currentToken);case"TemplateLiteralExpStart":return this.parseTemplateLiteralExp();case"IdentifierLiteral":return t=new c.IdentifierLiteralExpression(this.currentToken),this.excutionFlag&r.NEED_PURE_IDENTIFIER?t:this.tryParseAssign(t)||!this.isParsingVarDeclaration&&this.tryParse(t)||t;case"StringLiteral":return this.tryParse(new d.StringLiteralExpression(this.currentToken));case"UnclosedStringLiteral":return new a.UnExpectStatement(new d.StringLiteralExpression(this.currentToken),"unclosed string",this.currentToken.loc);case"NumberLiteral":return t=new O.NumberLiteralExpression(this.currentToken),this.tryParse(t);case"Operator":return!e.expectOperator&&s.Patterns.prefixUnary.test(this.currentToken.value)?this.parseUnaryExpression():null;case"RegExpStart":return e.expectOperator?null:this.parseRegStatement();case"IllegalToken":return new a.UnExpectStatement(this.currentToken.value,"Illegal token",this.currentToken.loc)}return!this.currentToken.value&&this.isReadAll()&&this.parsingNode&&(this.parsingNode.isUnexpectEnd=!0),null}next(){return this.skipSpace(),this.currentToken={loc:{start:null,end:null}},this.currentToken.loc.start=this.pos,this.readWord(),this.currentToken.loc.end=this.pos,this.tokens.push(Object.assign(this.currentToken)),this.currentToken}readWord(){if(o.isIdentifierStart(this.curCharCode))this.currentToken.value=this.readIdentifier(),this.excutionFlag&r.IS_PARSING_ACCESSPROP||this.excutionFlag&r.IS_PARSING_OBJECT_KEY||"instanceof"!==this.currentToken.value&&"in"!==this.currentToken.value?!s.Patterns.keywords.test(this.currentToken.value)||this.excutionFlag&r.IS_PARSING_ACCESSPROP||this.excutionFlag&r.IS_PARSING_OBJECT_KEY?s.Patterns.ParticularLiteral.test(this.currentToken.value)?this.currentToken.type="ParticularLiteral":this.currentToken.type="IdentifierLiteral":this.currentToken.type="Keyword":this.currentToken.type="Operator";else if(o.isNumberStart(this.curCharCode))this.currentToken.type="NumberLiteral",this.currentToken.value=this.readNumber();else if(39===this.curCharCode||34===this.curCharCode){let e=this.readString();this.curCharCode!==this.stringStartToken?this.currentToken.type="UnclosedStringLiteral":(this.currentToken.type="StringLiteral",this.advance()),this.currentToken.value=e}else if(s.Patterns.operators.test(this.curChar))this.currentToken.type="Operator",this.currentToken.value=this.readOperator(),this.currentToken.isAssignOperator=s.Patterns.assign.test(this.currentToken.value);else{let e=this.pos;this.advance(),this.currentToken.value=this.input.slice(e,this.pos),s.Patterns.blockStart.test(this.currentToken.value)?this.currentToken.type="BlockStart":s.Patterns.blockClose.test(this.currentToken.value)?this.currentToken.type="BlockClose":"`"===this.currentToken.value?this.currentToken.type="TemplateLiteralExpStart":this.currentToken.value&&";.,:".indexOf(this.currentToken.value)<0&&(this.currentToken.value+=this.readIllegalToken(),this.currentToken.type="IllegalToken")}}readIllegalToken(){let e=this.pos;for(;!this.isLineEnd()&&";"!==this.curChar;)this.advance();return this.input.slice(e,this.pos)}readNumber(){let e=this.pos;return this.consumeNumber(),this.input.slice(e,this.pos)}consumeNumber(){if(48===this.curCharCode)switch(this.nextCharCode){case 98:this.advance(2),this.consumeBinary();break;case 120:this.advance(2),this.consumeHex();break;default:this.advance()}else{this.currentToken.type="NumberLiteral";let e=!1;for(;(o.isNumberCharCode(this.curCharCode)||46===this.curCharCode)&&!this.isReadAll();){if(46===this.curCharCode){if(e)return void this.consumeUnexpect([]);e=!0}this.advance()}}}readString(){this.stringStartToken=this.curCharCode,this.advance();let e=this.pos;return this.consumeString(),this.input.slice(e,this.pos)}consumeString(){for(;this.curCharCode!==this.stringStartToken&&10!==this.curCharCode&&!this.isReadAll();)this.advance()}readIdentifier(){let e=this.pos;return this.advance(),this.consumeIdentifier(),this.input.slice(e,this.pos)}consumeIdentifier(){for(;o.isIdentifierChar(this.curCharCode)&&(this.advance(),!this.isReadAll()););}readOperator(){let e=this.pos;return(s.Patterns.canReapeat.test(this.curChar)&&this.nextCharCode===this.curCharCode||s.Patterns.canPrefixAssign.test(this.curChar)&&61===this.nextCharCode||33===this.curCharCode&&61===this.nextCharCode)&&this.advance(),61===this.curCharCode&&61===this.nextCharCode&&this.advance(),this.advance(),this.input.slice(e,this.pos)}safelyParseNode(){let e=this.parseNode();return this.parsingNode&&o.assertUnexpect(this.parsingNode,e)?null:e}getExpectedNode(e){let t=this.safelyParseNode();if(t){if((e&t.code)===t.code)return t;this.parsingNode.unexpectedNodes.push(new a.UnExpectStatement(t,"应为表达式"))}else if(this.isReadAll())this.parsingNode.isUnexpectEnd=!0;else{if(this.parsingNode&&this.parsingNode.unexpectedNodes.length)return null;if("("===this.currentToken.value&&e===r.NodeCode.Expression)return this.parseBracketEnwrapedExpression();if("{"===this.currentToken.value&&(e&r.NodeCode.ObjectLiteralExpression)===r.NodeCode.ObjectLiteralExpression)return this.parseObjLiteralExp();if("["===this.currentToken.value&&(e&r.NodeCode.ArrayLiteralExpression)===r.NodeCode.ArrayLiteralExpression)return this.parseArrExp();if("/"===this.currentToken.value&&(e&r.NodeCode.RegExpression)===r.NodeCode.RegExpression)return this.parseRegStatement();this.parsingNode.unexpectedNodes.push(new a.UnExpectStatement(this.currentToken.value,`字符 '${this.currentToken.value}' 不该出现在此处`,this.currentToken.loc))}return null}expectExpression(){return this.getExpectedNode(r.NodeCode.Expression)}tryToGetExpectedNode(e){let t=this.markPos(),i=this.parseNode();return i&&!i.unexpectedNodes.length&&(i.code&e)===i.code?i:(t(),null)}parseBlock(e=(e=>!e&&"}"===this.currentToken.value)){let t=this.depth;this.depth++;let i=new g.Block,n=this.excutionFlag,s=this.parsingNode;for(i.loc={start:this.pos,end:null},i.depth=this.depth,this.excutionFlag=0,this.parsingNode=null;;){if(this.isReadAll()){s.isUnexpectEnd=!0;break}let t=this.parseNode();if(!t)if("{"===this.currentToken.value){const e=this.markPos();t=this.parseObjLiteralExp(),t.code===r.NodeCode.ObjectLiteralExpression&&!t.properties.length&&t.unexpectedNodes.length&&(e(),t=this.parseBlock())}else"["===this.currentToken.value&&(t=this.parseArrExp());if(t&&(t.isUnexpectEnd?i.body.push(new a.UnExpectStatement(t,"unexpect end value")):i.body.push(t)),e(t))break}this.excutionFlag=n,this.parsingNode=s,this.depth=t;let o=i.body.length;return i.loc.end=o?i.body[o-1].loc.end:i.loc.start,i}parseUnaryExpression(){let e=new L.UnaryExpression(this.currentToken),t=this.startParse(e);return e.prefix=!0,e.operator=this.currentToken.value,e.argument=this.expectExpression(),t()}parseImportStatement(){let e=this.tryToParseCallExpression(new c.IdentifierLiteralExpression(this.currentToken));if(e)return e;{e=new l.ImportStatement(this.currentToken);let t=this.startParse(e,r.IS_PARSING_IMPORT);if(e.from=this.tryToGetExpectedNode(r.NodeCode.StringLiteralExpression))return t();if(this.consumeNextWordIfMatch("{"))e.specifiers=this.getImportedSpecifiers();else if((e.imported=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression))&&this.consumeNextWordIfMatch("as")&&!(e.local=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression)))return t();return e.unexpectedNodes.length||!this.expectToken("from")||(e.from=this.getExpectedNode(r.NodeCode.StringLiteralExpression)),t()}}getImportedSpecifiers(){let e=[],t=!1;for(;!this.consumeNextWordIfMatch("}")&&!this.isReadAll();){if(t){if(!this.expectToken(","))break}else{let t=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression);if(!t)break;let i={imported:t,local:null};if((this.consumeNextWordIfMatch(":")||this.consumeNextWordIfMatch("as"))&&!(i.local=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression)))break;e.push(i)}t=!t}return e}parseVarDeclarationStatement(){this.isParsingVarDeclaration=!0;let e,t=new m.VariableDeclarationStatement(this.currentToken),i=this.startParse(t,r.IS_PARSING_VARDECLARATION);for(;(e=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression|r.NodeCode.AssignmentExpression))&&(t.declarations.push(e),this.consumeNextWordIfMatch(",")););return this.isParsingVarDeclaration=!1,i()}parseFunDeclarationStatement(){let e="function"!==this.currentToken.value,t=new y.FunctionDeclarationStatement(this.currentToken),i=this.startParse(t,r.IS_PARSING_FUNDECLARATION);if(this.isParsingFunDeclaration=!0,(t.identifier=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression))&&this.expectToken("(")){let e;if(!this.consumeNextWordIfMatch(")"))for(;(e=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression))&&(t.params.push(e),!this.consumeNextWordIfMatch(")"));)this.expectToken(",")}return e&&t.identifier&&(t.loc.start=t.identifier.loc.start),t.unexpectedNodes.length||this.expectToken("{")&&(t.body=this.parseBlock(),t.body.functionBlock=!0),i()}tryParseFunciotnExpress(){let e=this.currentToken;if(this.consumeNextWordIfMatch("(")){this.isParsingFunDeclaration=!0;let t,i=new W.FunctionExpression(e),n=this.startParse(i);if(!this.consumeNextWordIfMatch(")"))for(;(t=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression))&&(i.params.push(t),!this.consumeNextWordIfMatch(")")&&this.expectToken(",")););return!i.unexpectedNodes.length&&this.expectToken("{")&&(i.body=this.parseBlock(),i.body.functionBlock=!0),n()}return null}parseObjLiteralExp(){let e,t,i=new v.ObjectLiteralExpression(this.currentToken),n=this.startParse(i);for(this.excutionFlag|=r.IS_PARSING_OBJECT_KEY;!this.consumeNextWordIfMatch("}")&&(e=this.getExpectedNode(r.NodeCode.ObjectKey))&&(this.excutionFlag&=~r.IS_PARSING_OBJECT_KEY,this.expectToken(":")&&(t=this.getExpectedNode(r.NodeCode.Expression)))&&(i.properties.push({key:e,value:t}),this.excutionFlag|=r.IS_PARSING_OBJECT_KEY,!this.consumeNextWordIfMatch("}")&&this.expectToken(",")););return this.excutionFlag&=~r.IS_PARSING_OBJECT_KEY,i.unexpectedNodes.length?n():this.tryParse(n(!1))}parseArrExp(){let e,t=new w.ArrayLiteralExpression(this.currentToken),i=this.startParse(t);for(;!this.consumeNextWordIfMatch("]")&&(e=this.expectExpression())&&(t.items.push(e),!this.consumeNextWordIfMatch("]")&&this.expectToken(",")););return t.unexpectedNodes.length?i():this.tryParse(i(!1))}parseTryCatchStatment(){let e=new C.TryCathchStatement(this.currentToken),t=this.startParse(e,r.IS_PARSING_TRY);if(!this.expectToken("{"))return t();if(e.body=this.parseBlock(),this.consumeNextWordIfMatch("catch")){let i=this.parseCatchHandler();if(i.unexpectedNodes.length)return e.unexpectedNodes.push(i),t();e.catchHandler=i}return this.consumeNextWordIfMatch("finally")&&this.expectToken("{")&&(e.finalizer=this.parseBlock()),e.catchHandler||e.finalizer||e.unexpectedNodes.push(new a.UnExpectStatement(this.currentToken.value,"expect finally",this.currentToken.loc)),t()}parseCatchHandler(){let e=new y.FunctionDeclarationStatement(this.currentToken),t=this.startParse(e,r.IS_PARSING_FUNDECLARATION);if(this.isParsingFunDeclaration=!0,e.identifier=new c.IdentifierLiteralExpression(this.currentToken),this.expectToken("(")){let t;if(!this.consumeNextWordIfMatch(")"))for(;(t=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression))&&(e.params.push(t),!this.consumeNextWordIfMatch(")"));)this.expectToken(",")}return e.unexpectedNodes.length||this.expectToken("{")&&(e.body=this.parseBlock(),e.body.functionBlock=!0),t()}parseDoWihleStatement(){let e=new S.DoWhileStatement(this.currentToken),t=this.startParse(e,r.IS_PARSING_DOWHILE);return this.isParsingLoop=!0,this.expectToken("{")?(e.body=this.parseBlock(),this.expectToken("while")&&this.expectToken("(")&&(e.test=this.expectExpression())&&this.expectToken(")"),t()):t()}parseWhileStatment(){let e=new E.WhileStatement(this.currentToken),t=this.startParse(e,r.IS_PARSING_SWITCH);return this.isParsingLoop=!0,this.expectToken("(")&&(e.test=this.expectExpression())&&this.expectToken(")")&&this.expectToken("{")&&(e.consequence=this.parseBlock()),t()}parseExpressions(e){let t=[];for(;!this.isReadAll();){let i=this.expectExpression();if(t.push(i),this.isNextWordIs(e)||!this.consumeNextWordIfMatch(","))return t}}parseForStatement(){let e=new b.ForStatement(this.currentToken),t=this.startParse(e);if(this.isParsingLoop=!0,!this.expectToken("("))return t();if(!this.consumeNextWordIfMatch(";")){let i=this.getExpectedNode(r.NodeCode.Expression|r.NodeCode.VariableDeclarationStatement);if(!i)return t();if((i.code===r.NodeCode.IdentifierLiteralExpression||i.code===r.NodeCode.VariableDeclarationStatement&&1===i.declarations.length&&i.declarations[0].code!==r.NodeCode.AssignmentExpression)&&((e.forOf=this.consumeNextWordIfMatch("of"))||(e.forIn=this.consumeNextWordIfMatch("in"))))return e.left=i,e.forIn,(e.right=this.expectExpression())&&this.expectToken(")")&&this.expectToken("{")&&(e.body=this.parseBlock()),t();if(e.init=i,!this.expectToken(";"))return t()}return this.consumeNextWordIfMatch(";")||(e.test=this.expectExpression())||this.expectToken(";")?((this.consumeNextWordIfMatch(")")||this.expectToken(";")&&(e.update=this.parseExpressions(")"))&&this.expectToken(")"))&&this.expectToken("{")&&(e.body=this.parseBlock()),t()):t()}parseRegStatement(){let e=new A.RegExpressioin(this.currentToken),t=this.startParse(e),i=this.pos-1,n=!1;for(;!this.isReadAll()&&(n||"/"!==this.curChar);){if(this.advance(),"\n"===this.curChar)return e.unexpectedNodes.push(new a.UnExpectStatement(this.input.slice(i,this.pos),"未完成的正则表达式",{start:i,end:this.pos})),t();n?n=!1:"\\"===this.curChar&&(n=!0)}if(this.advance(),e.pattern=this.input.slice(i,this.pos),"i"===this.curChar||"g"===this.curChar){let t=this.markPos();this.next(),/i|g|ig|gi/.test(this.currentToken.value)?e.flag=this.currentToken.value:t()}return t()}parseIfStatement(){let e=new k.IfStatement(this.currentToken),t=this.startParse(e),i=!1;return this.expectToken("(")&&(e.test=this.expectExpression())&&this.expectToken(")")?(e.consequent=(()=>{if(this.consumeNextWordIfMatch("{"))return this.parseBlock();{i=!0;let t=this.currentLine,n=this.markPos(),r=new g.Block;if(this.consumeNextWordIfMatch("else"))return t===this.currentLine?(e.unexpectedNodes.push(new a.UnExpectStatement("else","statement expect",this.currentToken.loc)),null):(n(),r);if(this.consumeNextWordIfMatch(";"))return n(),r;let s=this.safelyParseNode();return s&&r.body.push(s),r}})(),e.unexpectedNodes.length||i&&!this.isLineEnd()||(i=!1,this.consumeNextWordIfMatch("else")&&(this.consumeNextWordIfMatch("if")?e.alternate=this.parseIfStatement():this.expectToken("{")&&(e.alternate=this.parseBlock()))),t()):t()}parseBreakStatement(){let e=new V.BreakStatement(this.currentToken),t=this.startParse(e);return this.isLineEnd()||this.isNextWordIs(";")||(e.argument=this.expectExpression()),this.isParsingLoop?t():new a.UnExpectStatement(t(),'"break" 语句只能在循环语句里使用')}parseReturnStatement(){let e=new _.ReturnStatement(this.currentToken),t=this.startParse(e);return this.isLineEnd()||this.isNextWordIs(";")||(e.argument=this.expectExpression()),this.isParsingFunDeclaration?t():new a.UnExpectStatement(t(),'A "return" statement can only be used within a function body')}parseContinueStatement(){let e=new K.ContinueStatement(this.currentToken),t=this.startParse(e);return this.isLineEnd()||this.isNextWordIs(";")||(e.argument=this.expectExpression()),this.isParsingLoop?t():new a.UnExpectStatement(t(),'"continue" 语句只能用在循环语句内')}parseSwitchStatement(){let e,t=new T.SwitchStatement(this.currentToken),i=this.startParse(t);if(!(this.expectToken("(")&&(t.discriminant=this.expectExpression())&&this.expectToken([")","{"])))return i();for(;!this.consumeNextWordIfMatch("}")&&(e=this.parseCaseStatement())&&!e.unexpectedNodes.length;)t.cases.push(e);return i()}parseCaseStatement(){if(!this.consumeNextWordIfMatch("case")&&!this.consumeNextWordIfMatch("default"))return this.next(),this.parsingNode.unexpectedNodes.push(new a.UnExpectStatement(this.currentToken.value,'expect "case" or "default"',this.currentToken.loc)),null;let e=new N.SwitchCaseStatement(this.currentToken),t=this.startParse(e,r.IS_PARSING_CASE);if(this.isParsingLoop=!0,e.isDefault="default"===this.currentToken.value,!e.isDefault&&!(e.test=this.expectExpression()))return t();if(this.expectToken(":"))if(this.consumeNextWordIfMatch("{"))e.consequent=this.parseBlock();else{let t=this.markPos();e.consequent=this.parseBlock((e=>{if(!e&&["case","default","}"].includes(this.currentToken.value))return t(),!0;t=this.markPos()}))}return t()}parseThrowStatement(){let e=new B.ThrowStatement(this.currentToken),t=this.startParse(e);return e.argument=this.expectExpression(),t()}parseWithStatement(){let e=new I.WithStatement(this.currentToken),t=this.startParse(e);return this.expectToken("(")&&(e.context=this.expectExpression())&&this.expectToken(")")&&this.expectToken("{")&&(e.body=this.parseBlock()),t()}parseDeleteStatement(){let e=new F.DeleteStatement(this.currentToken),t=this.startParse(e);return e.argument=this.getExpectedNode(r.NodeCode.MemberExpression),t()}parseNewStatement(){let e=new P.NewExpressioin(this.currentToken),t=this.startParse(e);return e.callee=this.getExpectedNode(r.NodeCode.CallExpression|r.NodeCode.IdentifierLiteralExpression),t()}parseClassDeclarationStatement(){let e=new D.ClassDeclarationStatement(this.currentToken),t=this.startParse(e,r.IS_PARSING_CLASSDECLARATION);if(!(e.className=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression))||this.consumeNextWordIfMatch("extends")&&!(e.super=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression))||!this.expectToken("{"))return t();for(;!this.consumeNextWordIfMatch("}")&&!this.isReadAll();){let i=this.parseClassMehod();if(!i)return t();e.methods.push(i)}return t()}parseClassMehod(){let e=this.markPos();if(this.next(),"IdentifierLiteral"!==this.currentToken.type)return this.parsingNode.unexpectedNodes.push(new a.UnExpectStatement(this.currentToken.value,"expect identifier",this.currentToken.loc)),null;e();let t=this.parseFunDeclarationStatement();return t.unexpectedNodes.length?(this.parsingNode.unexpectedNodes.push(t),null):t}parseExportStatement(){let e=new R.ExportDeclarationStatement(this.currentToken),t=this.startParse(e);if(this.consumeNextWordIfMatch("{")){let i;for(;i=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression);){let n={exported:i,local:null};if(this.consumeNextWordIfMatch("as")){if(!(n.local=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression)))return t();e.specifiers.push(n)}if(e.specifiers.push(n),this.consumeNextWordIfMatch("}"))break;if(!this.expectToken(","))return t()}}else{let i=this.getExpectedNode(r.NodeCode.Declaration|r.NodeCode.IdentifierLiteralExpression);if(!i)return t();if(e.exported=i,(i.code&r.NodeCode.Declaration)===i.code)return t();if(this.consumeNextWordIfMatch("as")&&!(e.local=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression)))return t()}return this.expectToken("from")&&(e.from=this.getExpectedNode(r.NodeCode.StringLiteralExpression)),t()}parseTypeOfExpression(){let e=new z.TypeOfExpression(this.currentToken),t=this.startParse(e,r.IS_PARSING_TYPEOF);return e.argument=this.expectExpression(),e.unexpectedNodes.length?t():this.tryParse(t(!1))}parseVoidExpression(){let e=new G.VoidExpression(this.currentToken),t=this.startParse(e,r.IS_PARSING_VOID);return e.argument=this.expectExpression(),e.unexpectedNodes.length?t():this.tryParse(t(!1))}parseTemplateLiteralExp(){let e=new x.TemplateLiteralExppression(this.currentToken),t=this.startParse(e),i=()=>{for(;96!==this.curCharCode&&!this.isReadAll()&&"${"!==this.input.slice(this.pos+1,this.pos+3);)this.advance()};for(;96!==this.curCharCode;){let n,r,s=this.pos;if(i(),n=new d.StringLiteralExpression({value:this.input.slice(s,this.pos),loc:{start:s,end:this.pos}}),this.isReadAll())return n&&e.unexpectedNodes.push(new a.UnExpectStatement(n,"未闭合的模板字符串",{start:e.loc.start,end:this.pos})),t();if(e.content.push(n),96===this.curCharCode)break;if(!(r=this.expectExpression())||!this.expectToken("}"))break;e.content.push(r)}return this.advance(),t()}parseBracketEnwrapedExpression(){let e=new H.BracketEnwrapedExpressioin(this.currentToken),t=this.excutionFlag;this.excutionFlag=0;let i=this.startParse(e);return(e.expression=this.expectExpression())&&this.expectToken(")")?(this.excutionFlag=t,this.tryParse(i(!1))):(this.excutionFlag=t,i())}tryParse(e){let t=this.tryParseTernary(e)||this.tryParseSuffixUnary(e)||this.tryParseMember(e)||this.tryParseComputedMember(e)||this.tryToParseCallExpression(e)||this.parseBinaryExpression(e)||e;return t!==e||this.parsingNode||(this.parsingNode=e,this.expectExpressionEnd(),this.parsingNode=null),t}tryParseTernary(e){if(this.excutionFlag&r.IS_PARSING_COMPUTE||!this.consumeNextWordIfMatch("?"))return null;let t=new f.TernaryExpression(e),i=this.startParse(t);return(t.consequent=this.expectExpression())&&this.expectToken(":")&&(t.alternate=this.expectExpression()),i()}tryParseMember(e){if(!this.consumeNextWordIfMatch("."))return null;let t=new p.MemberExpression(e),i=this.startParse(t,r.IS_PARSING_ACCESSPROP);if(t.property=this.getExpectedNode(r.NodeCode.IdentifierLiteralExpression)){let e=i(!1);return this.tryParseAssign(e)||this.tryParse(e)}return i()}tryParseComputedMember(e){if(!this.consumeNextWordIfMatch("["))return null;let t=new p.MemberExpression(e);t.isComputed=!0;let i=this.startParse(t);if((t.property=this.expectExpression())&&this.consumeNextWordIfMatch("]")){let e=i(!1);return this.tryParseAssign(e)||this.tryParse(e)}return i()}tryToParseCallExpression(e){if(!this.consumeNextWordIfMatch("("))return null;let t=new u.CallExpression(e),i=this.startParse(t);if(!this.consumeNextWordIfMatch(")"))for(;!this.isReadAll();){let e=this.expectExpression();if(!e)return i();if(t.arguments.push(e),this.consumeNextWordIfMatch(")"))break;if(!this.expectToken(","))return i()}return this.tryParse(i(!1))}tryParseSuffixUnary(e){if(e.code!==r.NodeCode.IdentifierLiteralExpression&&e.code!==r.NodeCode.MemberExpression)return null;let t=this.markPos();if(this.next(),!s.Patterns.canBeSuffixUnary.test(this.currentToken.value))return t(),null;let i=new L.UnaryExpression(this.currentToken);return i.suffix=!0,i.argument=e,i.loc.start=e.loc.start,this.startParse(i)()}tryParseAssign(e){if((e.code&r.NodeCode.AssigmentLeft)!==e.code)return null;let t=this.markPos();if(this.next(),!this.currentToken.isAssignOperator)return t(),null;let i=this.isParsingVarDeclaration;this.isParsingVarDeclaration=!1;let n=new U.AssignmentExpression({loc:{start:e.loc.start}}),s=this.startParse(n);return n.left=e,this.excutionFlag&r.IS_PARSING_VARDECLARATION&&"="!==this.currentToken.value?(n.unexpectedNodes.push(new a.UnExpectStatement(this.currentToken.value,'expect "="',this.currentToken.loc)),s()):(n.operator=this.currentToken.value,n.right=this.expectExpression(),this.isParsingVarDeclaration=i,s())}parseBinaryExpression(e){if(this.excutionFlag&r.IS_PARSING_TYPEOF||this.excutionFlag&r.IS_PARSING_VOID)return e;let t=this.markPos();if(this.next(),this.excutionFlag&r.IS_PARSING_COMPUTE||"Operator"!==this.currentToken.type)return t(),e;let i,n,s=(e,t,i)=>{r.priorityMap[e.operator]<r.priorityMap[t.operator]?e.right.code===r.NodeCode.BinaryExpression?s(e.right,t,e):(t.left=e.right,e.right=t,n=e):(t.left=e,i?i.right=t:(a=t,l(),l=this.startParse(a,r.IS_PARSING_COMPUTE)))},o=e=>{e.left.code===r.NodeCode.BinaryExpression&&o(e.left),e.loc.start=e.left.loc.start,e.right&&(e.right.code===r.NodeCode.BinaryExpression&&o(e.right),e.loc.end=e.right.loc.end)},a=i=new h.BinaryExpression(e);a.operator=this.currentToken.value;let l=this.startParse(a,r.IS_PARSING_COMPUTE);for(i.right=this.getExpectedNode(r.NodeCode.Expression);i.right;){let e=this.markPos();if(this.next(),"Operator"!==this.currentToken.type||"?"===this.currentToken.value){e();break}let t=new h.BinaryExpression;if(t.operator=this.currentToken.value,s(i,t,n),i=t,i.right=this.getExpectedNode(r.NodeCode.Expression),this.isReadAll())break}return o(a),this.tryParseTernary(l())||a}parseIsStartWithKeyword(){switch(this.currentToken.value){case"import":return this.parseImportStatement();case"let":case"const":case"var":return this.parseVarDeclarationStatement();case"function":return this.tryParseFunciotnExpress()||this.parseFunDeclarationStatement();case"try":return this.parseTryCatchStatment();case"do":return this.parseDoWihleStatement();case"while":return this.parseWhileStatment();case"for":return this.parseForStatement();case"if":return this.parseIfStatement();case"return":return this.parseReturnStatement();case"switch":return this.parseSwitchStatement();case"throw":return this.parseThrowStatement();case"with":return this.parseWithStatement();case"delete":return this.parseDeleteStatement();case"typeof":return this.parseTypeOfExpression();case"void":return this.parseVoidExpression();case"new":return this.parseNewStatement();case"class":return this.parseClassDeclarationStatement();case"export":return this.parseExportStatement();case"break":return this.parseBreakStatement();case"continue":return this.parseContinueStatement();default:return null}}skipLineComment(){for(;13!==this.curCharCode&&10!==this.curCharCode&&this.pos<this.input.length;)this.advance()}skipBlockComment(){for(;"*/"!==this.input.slice(this.pos,this.pos+2)&&this.pos<this.input.length;)this.advance();this.pos+=2}consumeBinary(){for(;this.curCharCode>=48&&this.curCharCode<=49&&!this.isReadAll();)this.advance()}consumeHex(){for(;o.isHexCharCode(this.curCharCode)&&!this.isReadAll();)this.advance()}consumeUnexpect(e){for(;!e.some((e=>e(this.curCharCode)))&&!this.isReadAll();)this.advance()}}t.JavascriptAstParsser=$,$.nonASCIIwhitespace=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/},2490:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCode=t.ExpectCloseMap=t.priorityMap=t.NEED_PURE_IDENTIFIER=t.IS_PARSING_OBJECT_KEY=t.IS_PARSING_VOID=t.IS_PARSING_TYPEOF=t.IS_PARSING_SWITCH=t.IS_PARSING_ACCESSPROP=t.IS_PARSING_FUNDECLARATION=t.IS_PARSING_VARDECLARATION=t.IS_PARSING_IMPORT=t.IS_PARSING_CLASSDECLARATION=t.IS_PARSING_DOWHILE=t.IS_PARSING_TRY=t.IS_PARSING_CASE=t.IS_PARSING_COMPUTE=void 0,t.IS_PARSING_COMPUTE=1,t.IS_PARSING_CASE=2,t.IS_PARSING_TRY=4,t.IS_PARSING_DOWHILE=8,t.IS_PARSING_CLASSDECLARATION=16,t.IS_PARSING_IMPORT=32,t.IS_PARSING_VARDECLARATION=64,t.IS_PARSING_FUNDECLARATION=128,t.IS_PARSING_ACCESSPROP=256,t.IS_PARSING_SWITCH=512,t.IS_PARSING_TYPEOF=1024,t.IS_PARSING_VOID=2048,t.IS_PARSING_OBJECT_KEY=4096,t.NEED_PURE_IDENTIFIER=t.IS_PARSING_FUNDECLARATION|t.IS_PARSING_ACCESSPROP,t.priorityMap={"+":14,"-":14,"*":15,"/":15,"=":3,"+=":3,"-=":3,"*=":3,"/=":3,"~=":3,"^=":3,"|=":3,"&=":3,"?":4,instanceof:4,in:4,"&&":6,"||":5,"&":9,"^":8,"|":7,"==":10,"===":10,"!=":10,"!==":10,">":11,">=":11,"<":11,"<=":11},t.ExpectCloseMap={"[":"]","(":")",'"':'"',"'":"'","{":"}","`":"`","/":"/"};const i=1<<31,n=1<<30;t.NodeCode={IdentifierLiteralExpression:1|i,NumberLiteralExpression:2|i,StringLiteralExpression:4|i,ArrayLiteralExpression:8|i,ObjectLiteralExpression:16|i,ParticularLiteralExpression:32|i,TemplateLiteralExpression:64|i,ObjectKey:null,Literal:null,AssigmentLeft:null,TernaryExpression:-2147483520,UnaryExpression:-2147483392,AssignmentExpression:-2147483136,BinaryExpression:-2147482624,MemberExpression:-2147481600,CallExpression:-2147479552,RegExpression:-2147475456,NewExpression:-2147467264,TypeOfExpression:-2147450880,FunctionExpression:-2147418112,VoidExpression:-2147352576,BracketEnwrapedExpressioin:-2147221504,Expression:null,IfStatement:1|n,VariableDeclarationStatement:2|n,FunctionDeclarationStatement:4|n,ImportStatement:8|n,ClassDeclarationStatement:16|n,SwitchCaseStatement:32|n,SwitchStatement:64|n,DoWhileStatement:1073741952,ExportDeclarationStatement:1073742080,ForStatement:1073742336,ForOfStatement:1073742848,TryCathchStatement:1073743872,WhileStatement:1073745920,ForInStatement:1073750016,WithStatement:1073758208,ReturnStatement:1073774592,BreakStatement:1073807360,ContinueStatement:1073872896,ThrowStatement:1074003968,DeleteStatement:1074266112,UnexpectStatement:1074790400,Loop:null,Declaration:null},t.NodeCode.ObjectKey=t.NodeCode.StringLiteralExpression|t.NodeCode.IdentifierLiteralExpression,t.NodeCode.Literal=["IdentifierLiteralExpression","NumberLiteralExpression","StringLiteralExpression","ArrayLiteralExpression","ObjectLiteralExpression","ParticularLiteralExpression","TemplateLiteralExpression"].reduce(((e,i)=>e|t.NodeCode[i]),0),t.NodeCode.AssigmentLeft=t.NodeCode.IdentifierLiteralExpression|t.NodeCode.MemberExpression,t.NodeCode.Expression=["IdentifierLiteralExpression","NumberLiteralExpression","StringLiteralExpression","ArrayLiteralExpression","ObjectLiteralExpression","ParticularLiteralExpression","TemplateLiteralExpression","TernaryExpression","UnaryExpression","AssignmentExpression","BinaryExpression","MemberExpression","CallExpression","RegExpression","NewExpression","TypeOfExpression","FunctionExpression","VoidExpression","BracketEnwrapedExpressioin"].reduce(((e,i)=>e|t.NodeCode[i]),0),t.NodeCode.Loop=["DoWhileStatement","ForStatement","ForOfStatement","WhileStatement","ForInStatement"].reduce(((e,i)=>e|t.NodeCode[i]),0),t.NodeCode.Declaration=["VariableDeclarationStatement","FunctionDeclarationStatement","ExportDeclarationStatement","ClassDeclarationStatement"].reduce(((e,i)=>e|t.NodeCode[i]),0)},9261:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assertExpectNullStatement=t.assertUnexpect=t.getLast=t.getPriority=t.isHexCharCode=t.isOperator=t.isNumberStart=t.isNumberCharCode=t.isIdentifierChar=t.isIdentifierStart=void 0;const n=i(2490),r=i(9889),s=i(5194);function o(e,t,i){if(t&&"UnExpectStatement"===t.type)return e.unexpectedNodes.push(t),!0;let n=i?i(t):null;return n?(e.unexpectedNodes.push(new s.UnExpectStatement(t,n)),!0):void 0}t.isIdentifierStart=function(e){return e<65?36===e:e<91||(e<97?95===e:e<123)},t.isIdentifierChar=function(e){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123))},t.isNumberCharCode=function(e){return e>=48&&e<=57},t.isNumberStart=function(e){return e>=48&&e<=57},t.isOperator=function(e){return r.Patterns.operators.test(e)},t.isHexCharCode=function(e){return e>=48&&e<=57||e>=97&&e<=122||e>=65&&e<=90},t.getPriority=function(e){return"string"==typeof e&&n.priorityMap[e]||-1},t.getLast=function(e){return e[e.length-1]},t.assertUnexpect=o,t.assertExpectNullStatement=function(e,t,i){return!t||(o(e,t,(()=>`expect "${i}"`)),!1)}},7083:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AstNode=void 0,t.AstNode=class{constructor(){this.isUnexpectEnd=!1,this.unexpectedNodes=[],this.loc={start:null,end:null}}}},1498:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayLiteralExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="ArrayLiteralExpression",this.code=n.NodeCode.ArrayLiteralExpression,this.items=[],this.loc.start=e.loc.start}}t.ArrayLiteralExpression=s},6010:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AssignmentExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="AssignmentExpression",this.code=n.NodeCode.AssignmentExpression,this.loc.start=e.loc.start}}t.AssignmentExpression=s},7217:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.left=e,this.type="BinaryExpression",this.code=n.NodeCode.BinaryExpression,e&&(this.loc.start=e.loc.start)}}t.BinaryExpression=s},8964:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BracketEnwrapedExpressioin=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="BracketEnwrapedExpressioin",this.code=n.NodeCode.BracketEnwrapedExpressioin,this.loc.start=e.loc.start}}t.BracketEnwrapedExpressioin=s},2840:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.callee=e,this.type="CallExpression",this.code=n.NodeCode.CallExpression,this.arguments=[],this.loc.start=e.loc.start}}t.CallExpression=s},9749:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Expression=void 0;const n=i(2490),r=i(7083);class s extends r.AstNode{}t.Expression=s,s.code=n.NodeCode.Expression},550:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="FunctionExpression",this.code=n.NodeCode.FunctionExpression,this.params=[],this.loc.start=e.loc.start}}t.FunctionExpression=s},2050:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IdentifierLiteralExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.currentToken=e,this.type="IdentifierLiteralExpression",this.code=n.NodeCode.IdentifierLiteralExpression,Object.assign(this.loc,e.loc),this.identifier=e.value}}t.IdentifierLiteralExpression=s},1920:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MemberExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e,t){super(),this.owner=e,this.property=t,this.type="MemberExpression",this.code=n.NodeCode.MemberExpression,this.isComputed=!1,this.loc.start=e.loc.start}}t.MemberExpression=s},8266:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NewExpressioin=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="NewExpressioin",this.code=n.NodeCode.NewExpression,this.loc.start=e.loc.start}}t.NewExpressioin=s},2662:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NumberLiteralExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="NumberLiteralExpression",this.code=n.NodeCode.NumberLiteralExpression,Object.assign(this.loc,e.loc),this.value=e.value}}t.NumberLiteralExpression=s},3993:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectLiteralExpression=void 0;const n=i(9749),r=i(2490);class s extends n.Expression{constructor(e){super(),this.type="ObjectLiteralExpression",this.code=r.NodeCode.ObjectLiteralExpression,this.properties=[],this.loc.start=e.loc.start}}t.ObjectLiteralExpression=s},2759:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParticularLiteralExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="ParticularLiteralExpression",this.code=n.NodeCode.ParticularLiteralExpression,Object.assign(this.loc,e.loc),this.raw=e.value}}t.ParticularLiteralExpression=s},5705:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RegExpressioin=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="RegExpressioin",this.code=n.NodeCode.RegExpression,this.loc.start=e.loc.start}}t.RegExpressioin=s},482:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringLiteralExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="StringLiteralExpression",this.code=n.NodeCode.StringLiteralExpression,Object.assign(this.loc,e.loc),this.value=e.value}}t.StringLiteralExpression=s},9842:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TemplateLiteralExppression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="TemplateLiteralExppression",this.code=n.NodeCode.TemplateLiteralExpression,this.content=[],this.loc.start=e.loc.start}}t.TemplateLiteralExppression=s},2995:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TernaryExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e,t,i){super(),this.test=e,this.consequent=t,this.alternate=i,this.type="TernaryExpression",this.code=n.NodeCode.TernaryExpression,this.loc.start=e.loc.start}}t.TernaryExpression=s},4495:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeOfExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="TypeOfExpression",this.code=n.NodeCode.TypeOfExpression,this.loc.start=e.loc.start}}t.TypeOfExpression=s},4014:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnaryExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="UnaryExpression",this.code=n.NodeCode.UnaryExpression,this.loc.start=e.loc.start,this.operator=e.value}}t.UnaryExpression=s},6290:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VoidExpression=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="VoidExpression",this.code=n.NodeCode.VoidExpression,this.loc.start=e.loc.start}}t.VoidExpression=s},294:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreakStatement=void 0;const n=i(2490),r=i(9749);class s extends r.Expression{constructor(e){super(),this.type="BreakStatement",this.code=n.NodeCode.BreakStatement,this.loc.start=e.loc.start}}t.BreakStatement=s},3309:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ClassDeclarationStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="ClassDeclarationStatement",this.code=n.NodeCode.ClassDeclarationStatement,this.methods=[],this.loc.start=e.loc.start}}t.ClassDeclarationStatement=s},1538:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContinueStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="ContinueStatement",this.code=n.NodeCode.ContinueStatement,this.loc.start=e.loc.start}}t.ContinueStatement=s},9475:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="DeleteStatement",this.code=n.NodeCode.DeleteStatement,this.loc.start=e.loc.start}}t.DeleteStatement=s},5425:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DoWhileStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="DoWhileStatement",this.code=n.NodeCode.DoWhileStatement,this.loc.start=e.loc.start}}t.DoWhileStatement=s},7817:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExportDeclarationStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="ExportDeclarationStatement",this.code=n.NodeCode.ExportDeclarationStatement,this.specifiers=[],this.loc.start=e.loc.start}}t.ExportDeclarationStatement=s},1404:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ForStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="ForStatement",this.code=n.NodeCode.ForStatement,this.forIn=!1,this.forOf=!1,this.loc.start=e.loc.start}}t.ForStatement=s},9778:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDeclarationStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="FunctionDeclarationStatement",this.code=n.NodeCode.FunctionDeclarationStatement,this.params=[],this.loc.start=e.loc.start}}t.FunctionDeclarationStatement=s},4246:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IfStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="IfStatement",this.code=n.NodeCode.IfStatement,this.loc.start=e.loc.start}}t.IfStatement=s},5197:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImportStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="ImportStatement",this.code=n.NodeCode.ImportStatement,this.specifiers=[],this.from=null,this.loc.start=e.loc.start}}t.ImportStatement=s},1885:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReturnStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="ReturnStatement",this.code=n.NodeCode.ReturnStatement,this.loc.start=e.loc.start}}t.ReturnStatement=s},5446:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Statement=void 0;const n=i(7083);class r extends n.AstNode{}t.Statement=r},9085:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SwitchCaseStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="SwitchCaseStatement",this.code=n.NodeCode.SwitchCaseStatement,this.isDefault=!1,this.loc.start=e.loc.start}}t.SwitchCaseStatement=s},7536:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SwitchStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="SwitchStatement",this.code=n.NodeCode.SwitchStatement,this.cases=[],this.loc.start=e.loc.start}}t.SwitchStatement=s},8376:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThrowStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="ThrowStatement",this.code=n.NodeCode.ThrowStatement,this.loc.start=e.loc.start}}t.ThrowStatement=s},1482:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TryCathchStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="TryCathchStatement",this.code=n.NodeCode.TryCathchStatement,this.loc.start=e.loc.start}}t.TryCathchStatement=s},5194:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnExpectStatement=void 0;const n=i(2490),r=i(7083),s=i(5446);class o extends s.Statement{constructor(e,t,i){super(),this.value=e,this.msg=t,this.type="UnExpectStatement",this.code=n.NodeCode.UnexpectStatement,i?Object.assign(this.loc,i):e&&e instanceof r.AstNode&&(this.loc.start=e.loc.start,this.loc.end=e.loc.end)}}t.UnExpectStatement=o},718:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VariableDeclarationStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="VariableDeclarationStatement",this.code=n.NodeCode.VariableDeclarationStatement,this.declarations=[],this.loc.start=e.loc.start,this.declarationKeyWord=e.value}}t.VariableDeclarationStatement=s},7289:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WhileStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="WhileStatement",this.code=n.NodeCode.WhileStatement,this.loc.start=e.loc.start}}t.WhileStatement=s},3061:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WithStatement=void 0;const n=i(2490),r=i(5446);class s extends r.Statement{constructor(e){super(),this.type="WithStatement",this.code=n.NodeCode.WithStatement,this.loc.start=e.loc.start}}t.WithStatement=s},9889:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Patterns=void 0,t.Patterns={keywords:/^(?:break|case|catch|continue|debugger|default|do|else|finally|for|function|if|return|switch|throw|try|var|while|with|instanceof|typeof|void|delete|new|in|const|class|extends|export|import|from|let|as)$/,whiteSpaceOrComment:/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,reservedWordsStrict:/^(?:enum|await|implements|interface|let|package|private|protected|public|static|yield)$/,reservedWordsStrictBind:/^(?:enum|await|implements|interface|let|package|private|protected|public|static|yield|eval|arguments)$/,reservedWords:/^(?:enum|await)$/,keywordRelationalOperator:/^in(stanceof)?$/,stringStart:/^(?:'|")$/,blockStart:/^(?:\[|\(|\{)$/,blockClose:/^(?:\]|\)|\})$/,operators:/^(?:\+|-|\*|\/|\!|\||%|\&|\^|~|<<|>>|\+\+|--|>|<|>=|<=|\&\&|\|\||==|===|=|\!==|\?|instanceof|in)$/,lineBreak:/\r\n?|\n|\u2028|\u2029/,unaryOperator:/^(?:\+\+|\-\-|\+|\-|\!\~)$/,canPrefixAssign:/^(?:\+|\-|\*|\/|\||\%|\&|\^|\<\<|\>\>|\>|\<|\=)$/,assign:/^(?:\=|\+\=|\-\=|\*\=|\/\=|\%\=|\|\=|\&\=|\>\>\=|\<\<\=)$/,canReapeat:/^(?:\+|\-|\*|\||\&)$/,canBeSuffixUnary:/^(?:\+\+|\-\-)$/,ParticularLiteral:/\btrue\b|\bfalse\b|\bnull\b|\bundefined\b|\bNaN\b/,prefixUnary:/\+|-|~|\+\+|--|\!/}},3450:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefinitionType=void 0;class i{}t.DefinitionType=i,i.FUNCTION="function",i.CONST="const",i.VARIABLE="variable",i.METHOD="method",i.PROPERTY="property",i.CLASS="class",i.IMPORT="import"},972:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JavascriptScopeAnalyzer=void 0;const n=i(5171),r=i(2490),s=i(3742),o=i(1018),a=i(4353),l=i(3450);t.JavascriptScopeAnalyzer=class{constructor(){this.scheduledAssinments=[],this.scheduledVarDefCheck=[],this.scheduledNewExpression=[],this.definitionMap={},this.depth=0,this.applyingScheduled=!1}reset(){this.scheduledAssinments=[],this.scheduledVarDefCheck=[],this.scheduledNewExpression=[],this.definitionMap={},this.depth=0,this.currentScope=null}analyze(e,t){if(!e)return;this.depth++;let i=new a.Scope;return i.parent=t||this.currentScope,this.currentScope=i,e.scope=i,e.body.forEach((e=>{if(e instanceof n.Block)return this.analyze(e);(e.code&r.NodeCode.Expression)===e.code?this.analyzeExpression(e):this.analyzeStatement(e)})),this.currentScope=this.currentScope.parent,this.depth--,0!==this.depth||this.applyingScheduled||(this.applyingScheduled=!0,this.scheduledAssinments.forEach((e=>e())),this.scheduledNewExpression.forEach((e=>e())),this.scheduledVarDefCheck.forEach((e=>e())),this.applyingScheduled=!1),e.scope}analyzeStatement(e){switch(e.code){case r.NodeCode.VariableDeclarationStatement:this.analyzeVariable(e);break;case r.NodeCode.ImportStatement:this.analyzeImport(e);break;case r.NodeCode.FunctionDeclarationStatement:this.analyzeFunctionDeclaration(e);break;case r.NodeCode.ClassDeclarationStatement:this.analyzeClassDeclaration(e);break;case r.NodeCode.DeleteStatement:this.analyzeDeleteStatement(e);break;case r.NodeCode.DoWhileStatement:this.analyzeDoWhileStatement(e);break;case r.NodeCode.ExportDeclarationStatement:this.analyzeExported(e);break;case r.NodeCode.ForStatement:this.analyzeForStatement(e);break;case r.NodeCode.IfStatement:this.analyzeIfStatement(e);break;case r.NodeCode.ReturnStatement:this.analyzeReturn(e);break;case r.NodeCode.SwitchStatement:e.cases.forEach((e=>this.analyzeSwitchCase(e)));break;case r.NodeCode.ThrowStatement:this.analyzeThrowStatement(e);break;case r.NodeCode.TryCathchStatement:this.analyzeTryCatch(e);break;case r.NodeCode.WhileStatement:this.analyzeWhileStatement(e)}this.analyzeUnexpect(e)}analyzeWhileStatement(e){this.analyzeExpression(e.test),this.analyze(e.consequence)}analyzeTryCatch(e){this.analyze(e.body),e.catchHandler&&this.analyzeFunctionDeclaration(e.catchHandler),e.finalizer&&this.analyze(e.finalizer)}analyzeThrowStatement(e){this.analyzeExpression(e)}analyzeSwitchCase(e){this.analyzeExpression(e.test),this.analyze(e.consequent)}analyzeReturn(e){this.analyzeExpression(e.argument)}analyzeIfStatement(e){this.analyzeExpression(e.test),this.analyze(e.consequent),e.alternate&&(e.alternate.code?this.analyzeIfStatement(e.alternate):this.analyze(e.alternate))}analyzeForStatement(e){var t;let i=new a.Scope;i.parent=this.currentScope,this.currentScope=i,e.forIn||e.forOf?(this.analyzeExpression(e.right),e.left.code===r.NodeCode.VariableDeclarationStatement?this.analyzeVariable(e.left):this.analyzeExpression(e.left)):((null===(t=e.init)||void 0===t?void 0:t.code)===r.NodeCode.VariableDeclarationStatement?this.analyzeVariable(e.init):this.analyzeExpression(e.init),this.analyzeExpression(e.test),e.update&&e.update.forEach((e=>this.analyzeExpression(e)))),this.analyze(e.body),this.currentScope=this.currentScope.parent}analyzeExported(e){}analyzeDoWhileStatement(e){this.analyze(e.body),this.analyzeExpression(e.test)}analyzeDeleteStatement(e){this.analyzeExpression(e.argument)}setDefinition(e=null){let t=this.currentDefinition;return this.currentDefinition=e,()=>{this.currentDefinition=t}}setScope(e=null){let t=this.currentScope;return this.currentScope=e,()=>{this.currentScope=t}}setState({newDefinition:e,newScope:t}){let i=this.setDefinition(e),n=this.setScope(t);return()=>{i(),n()}}analyzeImport(e){[{imported:e.imported,local:e.local}].concat(e.specifiers).forEach((t=>{let i;t.local?i=new s.Definition(t.local,l.DefinitionType.IMPORT,o.DefinitionCode.ImportSpecifier,this.currentScope):e.imported&&(i=new s.Definition(t.imported,l.DefinitionType.IMPORT,o.DefinitionCode.ImportSpecifier,this.currentScope)),i&&(this.currentScope.addDefinition(i),this.currentScope.addUnuse(i))}))}analyzeVariable(e){let t,i;"const"===e.declarationKeyWord?(t=l.DefinitionType.CONST,i=o.DefinitionCode.ConstVariable):(t=l.DefinitionType.VARIABLE,i=o.DefinitionCode.Variable),e.declarations.forEach((e=>{let n=new s.Definition(e,t,i,this.currentScope);if(this.currentScope.addUnuse(n),e.code===r.NodeCode.AssignmentExpression){let t=this.currentScope,i=this.definitionMap,r=this.currentDefinition;this.currentDefinition=n,this.analyzeExpression(e.right),this.currentScope=t,this.definitionMap=i,this.currentDefinition=r}this.currentScope.addDefinition(n)}))}analyzeExpression(e){if(!e)return;let t=this.currentDefinition,i=this.currentScope;switch(e.code){case r.NodeCode.ArrayLiteralExpression:this.analyzeArray(e);break;case r.NodeCode.ObjectLiteralExpression:this.analyzeObject(e);break;case r.NodeCode.IdentifierLiteralExpression:this.scheduledVarDefCheck.push((()=>{let n=i.getDefinition(e.identifier);n?(i.deleteUnuse(n),t&&(t.definitions=n.definitions)):i.UndeclaredVariables.add(e)}));break;case r.NodeCode.FunctionExpression:this.analyzeFunExpression(e),this.currentDefinition&&(this.currentDefinition.definitions=o.getFunctionDefinitions());break;case r.NodeCode.RegExpression:this.currentDefinition&&(this.currentDefinition.definitions=o.getRegExpDefinitions());break;case r.NodeCode.StringLiteralExpression:this.currentDefinition&&(this.currentDefinition.definitions=o.getStringDefinitions());break;case r.NodeCode.TemplateLiteralExpression:this.analyzeTemplate(e);break;case r.NodeCode.AssignmentExpression:this.analyzeAssigment(e);break;case r.NodeCode.BinaryExpression:this.analyzeBinary(e);break;case r.NodeCode.CallExpression:this.analyzeCallExpression(e);break;case r.NodeCode.MemberExpression:this.analyzeMemberExpression(e);break;case r.NodeCode.BracketEnwrapedExpressioin:this.analyzeBracketEnwraped(e);break;case r.NodeCode.NewExpression:this.scheduledNewExpression.push((()=>{let n=this.setState({newDefinition:t,newScope:i});this.analyzeNewExpression(e),n()}));case r.NodeCode.TernaryExpression:this.analyzeTernaryExression(e);break;case r.NodeCode.TypeOfExpression:this.analyzeTypeOf(e);break;case r.NodeCode.VoidExpression:this.analyzeVoid(e);break;case r.NodeCode.UnaryExpression:this.analyzeUnary(e)}this.analyzeUnexpect(e)}analyzeUnexpect(e){e.unexpectedNodes.length&&e.unexpectedNodes.forEach((t=>{t.value.code&&((t.value.code&r.NodeCode.Expression)===e.code?this.analyzeExpression(t.value):this.analyzeStatement(t.value))}))}analyzeBracketEnwraped(e){this.analyzeExpression(e.expression)}analyzeUnary(e){this.analyzeExpression(e.argument)}analyzeTernaryExression(e){let t=this.setDefinition(null);this.analyzeExpression(e.test),this.analyzeExpression(e.consequent),this.analyzeExpression(e.alternate),t()}analyzeTypeOf(e){let t=this.setDefinition(null);this.analyzeExpression(e.argument),t()}analyzeVoid(e){let t=this.setDefinition(null);this.analyzeExpression(e.argument),t()}analyzeNewExpression(e){let t=e.callee.code===r.NodeCode.IdentifierLiteralExpression?e.callee.identifier:e.callee.callee.identifier;e.callee.arguments&&e.callee.arguments.forEach((e=>this.analyzeExpression(e)));let i=this.currentScope.getDefinition(t);if(i){if(this.currentScope.deleteUnuse(i),i.astNode.code!==r.NodeCode.ClassDeclarationStatement)return;let e=i.astNode;this.currentDefinition&&(this.currentDefinition.definitions=e.methods.map((e=>new s.Definition(e,l.DefinitionType.METHOD,o.DefinitionCode.Method,this.currentScope))))}}analyzeTemplate(e){e.content.forEach((e=>{e.code!==r.NodeCode.StringLiteralExpression&&(this.setDefinition(null),this.analyzeExpression(e))})),this.currentDefinition&&(this.currentDefinition.definitions=o.getStringDefinitions())}analyzeMemberExpression(e){if(e.owner.code===r.NodeCode.IdentifierLiteralExpression&&"this"===e.owner.identifier)return;let t=this.setDefinition(null);this.analyzeExpression(e.owner),t()}analyzeCallExpression(e){let t=this.setDefinition(null);this.analyzeExpression(e.callee),e.arguments.forEach((e=>this.analyzeExpression(e))),t()}analyzeBinary(e){let t=this.setDefinition(null);this.analyzeExpression(e.left),this.analyzeExpression(e.right),t()}analyzeArray(e){let t=this.setDefinition(null);e.items.forEach((e=>{this.analyzeExpression(e)})),t(),this.currentDefinition&&(this.currentDefinition.definitions=o.getArrayDefininitons())}analyzeAssigment(e){this.analyzeExpression(e.left),this.analyzeExpression(e.right)}analyzeObject(e){let t=e.properties.map((e=>{let t=new s.Definition(e.key,l.DefinitionType.PROPERTY,o.DefinitionCode.Property,this.currentScope),i=this.setDefinition(t);return this.analyzeExpression(e.value),i(),t}));this.currentDefinition&&(this.currentDefinition.definitions=t.concat(o.getObjectDefinitions()))}analyzeFunExpression(e){let t=new s.Definition(e,l.DefinitionType.FUNCTION,o.DefinitionCode.FunctionDeclaration,this.currentScope),i=new a.Scope,n=this.currentScope;return i.parent=this.currentScope,this.currentScope=i,e.params.forEach((e=>{let t=new s.Definition(e,l.DefinitionType.VARIABLE,o.DefinitionCode.Variable,this.currentScope);this.currentScope.addUnuse(t),this.currentScope.addDefinition(t)})),this.analyze(e.body),this.currentScope=n,t}analyzeFunctionDeclaration(e){let t=new s.Definition(e,l.DefinitionType.FUNCTION,o.DefinitionCode.FunctionDeclaration,this.currentScope);this.currentScope.addUnuse(t),this.currentScope.addDefinition(t);let i=new a.Scope,n=this.currentScope;return i.parent=this.currentScope,this.currentScope=i,e.params.forEach((e=>{let t=new s.Definition(e,l.DefinitionType.VARIABLE,o.DefinitionCode.Variable,this.currentScope);this.currentScope.addUnuse(t),this.currentScope.addDefinition(t)})),this.analyze(e.body),this.currentScope=n,t}analyzeClassDeclaration(e){let t=new s.Definition(e,l.DefinitionType.CLASS,o.DefinitionCode.ClassDeclaration,this.currentScope);return this.currentScope.addUnuse(t),this.currentScope.addDefinition(t),e.super&&this.analyzeExpression(e.super),t}}},5034:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0,t.Context=class{}},3742:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Definition=void 0;const n=i(2490);t.Definition=class{constructor(e,t,i,r){switch(this.astNode=e,this.definitionType=t,this.definitionCode=i,this.scope=r,this.type="Definition",e.code){case n.NodeCode.AssignmentExpression:this.identifier=e.left.identifier;break;case n.NodeCode.IdentifierLiteralExpression:this.identifier=e.identifier;break;case n.NodeCode.FunctionDeclarationStatement:this.identifier=e.identifier.identifier;break;case n.NodeCode.ClassDeclarationStatement:this.identifier=e.className.identifier}}}},4353:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Scope=void 0;const n=i(5034),r=i(1614);t.Scope=class{constructor(e){this.parent=e,this.definitions=[],this.definitionsMap={},this.context=new n.Context,this.functionScope=!1,this.exports=[],this.unusedDefination=new Map,this.UndeclaredVariables=new Set,this.id=r.v4()}addDefinition(e){this.definitions.push(this.definitionsMap[e.identifier]=e)}addDefinitions(e){e.forEach((e=>this.addDefinition(e)))}getDefinition(e){return this.definitionsMap[e]||this.parent&&this.parent.getDefinition(e)||null}deleteUnuse(e){this.unusedDefination.has(e.astNode)?this.unusedDefination.delete(e.astNode):this.parent&&this.parent.deleteUnuse(e)}addUnuse(e){this.unusedDefination.set(e.astNode,e)}isUnuse(e){return!!this.unusedDefination.get(e.astNode)}fullMatchDefinition(e){return this.definitionsMap[e]||this.fullMatchParentDefinitions(e)}matchParentDefinitions(e,t=0){return this.parent?this.parent.matchDefinitions(e,t):[]}fullMatchParentDefinitions(e){return this.parent?this.parent.fullMatchDefinition(e):[]}matchOwnDefinitions(e,t=0){return this.definitions.reduce(((i,n)=>{let r;if(n.identifier!==e&&(r=n.identifier.indexOf(e))>-1){let s=n.identifier.slice(0,r),o=n.identifier.slice(r+e.length);i.push({near:t,definition:n,index:r,text:e,textLeft:s,textRight:o})}return i}),[])}matchDefinitions(e,t=0){return this.matchOwnDefinitions(e,t).concat(this.matchParentDefinitions(e,t+1))}}},1018:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getStringDefinitions=t.getRegExpDefinitions=t.getFunctionDefinitions=t.getObjectDefinitions=t.getArrayDefininitons=t.getGlobalDefinitions=t.ObjectDefinitions=t.getConsoleDefinition=t.DefinitionCode=void 0;const n=i(2050),r=i(3742),s=["function","if","else","for","while","do","catch","class","asyn","await","switch","let","var","const","window","true","try","false","null","undefined","return","continue","break","default","require","__dirname",{identifier:new n.IdentifierLiteralExpression({value:"console",loc:{}}),props:[...Object.keys(console)]},{identifier:new n.IdentifierLiteralExpression({value:"document",loc:{}}),props:["querySelector","querySelectorAll","createElement","createEvent","getElementById","getElementsByClassName","getElementsByTagName"]},{identifier:new n.IdentifierLiteralExpression({value:"module",loc:{}}),props:["exports"]}];t.DefinitionCode={ConstVariable:1,Variable:2,ImportSpecifier:4,FunctionDeclaration:8,ClassDeclaration:16,Property:32,Method:64},t.getConsoleDefinition=function(e){let i=new n.IdentifierLiteralExpression({value:"console",loc:{}});return new r.Definition(i,"Variable",t.DefinitionCode.Variable,e)},t.ObjectDefinitions=[],t.getGlobalDefinitions=function e(i,o){return(o||s).map((s=>{if("string"==typeof s)return new r.Definition(new n.IdentifierLiteralExpression({value:s,loc:{}}),"Variable",t.DefinitionCode.Variable,i);{let n=new r.Definition(s.identifier,"Variable",t.DefinitionCode.Variable,i);return n.definitions=e(i,s.props),n}}))},t.getArrayDefininitons=function(){return[]},t.getObjectDefinitions=function(){return[]},t.getFunctionDefinitions=function(){return[]},t.getRegExpDefinitions=function(){return[]},t.getStringDefinitions=function(){return[]}},7615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyBoardProx=void 0,t.KeyBoardProx=class{constructor(){this.keydownListenerListMap={},this.inceptAllQueue=[],this.beforeAllCbs=[],this.keydownListener=e=>{let t=["altKey","ctrlKey","shiftKey"].reduce(((t,i)=>(e[i]&&(t+=t?";"+i:i),t)),"");t=t?t+";"+e.key:e.key;let i=this.keydownListenerListMap[t];i&&(this.inceptAllQueue.length&&!this.inceptAllQueue.every((t=>t(e)))||(this.beforeAllCbs.forEach((t=>t(e))),i.forEach((t=>t(e)))))},document.addEventListener("keydown",this.keydownListener)}remove(e,t){}inceptAll(e){this.inceptAllQueue.push(e)}destroy(){}beforeAll(e){this.beforeAllCbs.push(e)}onKeydown(e,t,i=""){let n=i?i+";"+e:e;this.keydownListenerListMap[n]||(this.keydownListenerListMap[n]=[]),this.keydownListenerListMap[n].push(t)}onKeyup(){}onKeypress(){}}},395:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Api=void 0;const n=i(1609),r=i(9182);t.Api=class{static getRootDir(e){return n.default.get(`${r.Config.SERVER_URL}/project/getDirectories`,{params:{project:e}})}static getFile(e){return n.default.get(`${r.Config.SERVER_URL}/project/getFile`,{params:{path:e,timestamp:Date.now()}})}static save(e){return n.default.post(`${r.Config.SERVER_URL}/project/save`,e)}static play(e){return n.default.get(`${r.Config.SERVER_URL}/project/server`,{params:{project:e}})}static createFile(e){return n.default.post(`${r.Config.SERVER_URL}/project/createFile`,e)}static createDir(e){return n.default.post(`${r.Config.SERVER_URL}/project/createDir`,e)}static delete(e){return n.default.delete(`${r.Config.SERVER_URL}/project/delete`,{params:e})}static paste(e){return n.default.post(`${r.Config.SERVER_URL}/project/paste`,e)}static rename(e){return n.default.post(`${r.Config.SERVER_URL}/project/rename`,e)}}},6646:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const n=i(7294),r=i(222),s=i(2274),o=i(8942);i(7398);const a=i(2872),l=i(395),d=i(1012),c=i(6056),h={currentFile:null,currentDir:null,rootDir:null},p={currentFileChange:new a.Subject,refresh:new a.Subject,search:new a.Subject,updateCurrentFileAndDirRef:new a.Subject,refreshDir:new a.Subject,askForName:new a.Subject,emitName:new a.Subject,setSelectedState:new a.Subject,action:new a.Subject},u={store:h,events:p,functions:{refreshDir:()=>l.Api.getRootDir("project1").then((e=>(200===e.data.status&&(h.rootDir=c.Directory.fromServerData(e.data.data)),e))),updateCurrentFileAndDirRef(e){var t,i;(null===(t=h.rootDir)||void 0===t?void 0:t.path)===e?(h.currentDir=h.rootDir,h.currentFile=null):(null===(i=h.rootDir)||void 0===i?void 0:i.children)&&function t(i){i.find((i=>{if(i.path===e)return i instanceof c.Directory?(h.currentDir=i,h.currentFile=null):(h.currentFile=i,h.currentDir=i.parent),!0;i.children&&i.children.length&&t(i.children)}))}(h.rootDir.children)}},api:l.Api};class f extends n.Component{constructor(e){super(e),this.state={code:null,showSideBarLoading:!1}}componentDidMount(){this.registerSideBarLoading()}registerSideBarLoading(){let e;u.functions.showSideBarLoading=(t=200)=>{e=setTimeout((()=>{this.setState({showSideBarLoading:!0})}),t)},u.functions.hideSideBarLoading=()=>{e&&clearTimeout(e),this.setState({showSideBarLoading:!1})}}render(){return n.createElement(s.MyContext.Provider,{value:u},n.createElement("div",{className:"app full-screen"},n.createElement("div",{className:"side-bar"},n.createElement("div",{className:"directory-container"},n.createElement(o.DirectoryComponent,null)),this.state.showSideBarLoading&&n.createElement("div",{className:"loading-cover"})),n.createElement("div",{className:"code-snippet-container"},n.createElement("div",{className:"controll-bar-wrapper"},n.createElement(d.ControllBar,null)),n.createElement("div",{className:"snippet-wrapper"},n.createElement(r.CodeSnippet,null)))))}}t.App=f,f.contextType=s.MyContext},222:function(e,t,i){var n=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeSnippet=void 0;const r=i(7294),s=i(7288);i(2636);const o=i(9658),a=i(5337),l=i(3134),d=i(972),c=i(410),h=i(7615),p=i(2215),u=i(5285),f=i(4353),x=i(1018),m=i(3253),y=i(650),g=i(8125),N=i(2274),C=i(7338),S=i(3640),E="rgb(38,79,120)";class b extends r.Component{constructor(e){super(e),this.editting=!1,this.cursorFlashing=!1,this.keyboardProx=new h.KeyBoardProx,this.inputBoxRef=r.createRef(),this.searchBoxRef=r.createRef(),this.cursorRef=r.createRef(),this.searchResult=[],this.nodeLinkedListUtil=new c.LinkedListUtil("prevNode","nextNode"),this.identifierLinkedListUtil=new c.LinkedListUtil("prevIdentifier","nextIdentifier"),this.boundaryLinkedListUtil=new c.LinkedListUtil("prevBoundary","nextBoundary"),this.forcePointerVisible=!1,this.isSelecting=!1,this.bgBlock1Style={},this.bgBlock2Style={},this.historyOperations=[],this.mergeEdit=0,this.focusedSearchResult=0,this.modification=[],this.isSearching=!1,this.operations=[],this.hintInfo={hintItems:[],focus:0},this.code=e.code,this.state={inputText:"",hideCursor:!1,headNode:null,menuVisible:!1,menuPos:{top:0,left:0}},this.keyboardProx.onKeydown("Backspace",(e=>{this.onBackspace(e)})),this.keyboardProx.onKeydown("ArrowLeft",(e=>{this.mergeEdit=0,this.onArrowLeft(e)})),this.keyboardProx.onKeydown("Escape",(e=>{this.onEscape()})),this.keyboardProx.onKeydown("ArrowRight",(e=>{this.mergeEdit=0,this.onArrowRight()})),this.keyboardProx.onKeydown("ArrowUp",(e=>{this.mergeEdit=0,this.onArrowUp(e)})),this.keyboardProx.onKeydown("ArrowDown",(e=>{this.mergeEdit=0,this.onArrowDown(e)})),this.keyboardProx.onKeydown("Enter",(e=>{this.deleteSelection(),this.onEnter()})),this.keyboardProx.onKeydown("Tab",(e=>{e.preventDefault(),this.onTab()})),this.keyboardProx.onKeydown("Tab",(e=>{e.preventDefault(),this.onBackTab()}),"shiftKey"),this.keyboardProx.onKeydown("z",(e=>{e.preventDefault(),this.cancelOperation()}),"ctrlKey"),this.keyboardProx.onKeydown("c",(e=>{e.preventDefault(),this.onCopy()}),"ctrlKey"),this.keyboardProx.onKeydown("v",(e=>{e.preventDefault(),this.onPaste()}),"ctrlKey"),this.keyboardProx.onKeydown("x",(e=>{e.preventDefault(),this.onCut()}),"ctrlKey"),this.keyboardProx.beforeAll((e=>{this.resetInput()})),this.keyboardProx.inceptAll((e=>!!this.pointer))}cancelOperation(){this.mergeEdit=0;let e=this.historyOperations.pop(),t=e.hisRenderNodeHead;e&&(this.forceVisible(),e.cancelEdit(),this.pointer.row=e.row,this.pointer.col=e.col,this.updatePointer(t),this.reAnalyze(t.block),this.checkIdentifier(u.Util.nodeLinkedListUntil.find(t,(e=>e.identifier&&e.block))),this.updateCharLength(),this.selection=e.selection,this.selection&&(this.selection.from.editting=u.Util.cloneCodeRenderNode(this.selection.from.source),this.selection.to.editting=u.Util.cloneCodeRenderNode(this.selection.to.source)),this.resetSelectionVertex(),this.forceUpdate())}onEscape(){this.closeHintBox()}onBackspace(e){if(this.pointer.node&&(1!==this.pointer.row||0!==this.pointer.col)&&!this.deleteSelection()){let t=this.pointer.node.left;if(this.mergeEdit=[1,3].includes(this.mergeEdit)?3:1,!t.length){if(this.pointer.col>0){let t=u.Util.nodeLinkedListUntil.findReversely(this.pointer.node.source.prevNode,(e=>e.text.length));this.pointer.node=new p.EdittingNode(t,this.pointer.col-t.col),this.onBackspace(e)}else{let e=u.Util.nodeLinkedListUntil.findReversely(this.pointer.node.source.prevNode,(e=>e.lineEnd));e.text||e.prevNode.lineEnd?e.lineEnd=!1:(e=e.prevNode,u.Util.nodeLinkedListUntil.linkAfter(e,e.nextNode.nextNode)),this.initOperation(),this.pointer.row--,this.pointer.col=e.col+e.text.length,this.pointer.node=new p.EdittingNode(e,e.text.length),this.updateCharLength(),this.refreshCode()}return}this.initOperation(),this.pointer.col--,this.pointer.node.left=t.slice(0,t.length-1),this.pointer.node.update(),this.modification.push({current:this.pointer.node.editting,origin:this.pointer.node.source}),this.updateCharLength(),this.refreshCode(),this.getCodeHints()}}tryApplyTabIndent(){let e=this.getSelectionVertex();if(e[0].row!==e[1].row){let t,i,n=!0;return u.Util.nodeLinkedListUntil.forEach(e[0].source,(e=>{if(n){let r=u.Util.getLineStart(e),s=u.Util.cloneCodeRenderNode(r),o=u.Util.getRowIndent(r);i||(i=r),t=o%4,s.text="".padStart(4-t," ")+s.text,this.modification.push({current:s,origin:r}),n=!1}e.lineEnd&&(n=!0)}),e[1].source),this.initOperation(),this.pointer.col+=4-t,e[1].col=this.pointer.col,this.refreshCode(i,e[1].source),!0}return!1}onTab(){if(this.tryApplyTabIndent())return;let e=0;if(this.hasSelection()){let t=this.getSelectionVertex();e=u.Util.getCharSizeFromRowHead(t[0].source)+u.Util.measureSizeOfText(t[0].source.text.slice(0,t[0].col-t[0].source.col))}else e=u.Util.getCharSizeFromRowHead(this.pointer.node.source)+u.Util.measureSizeOfText(this.pointer.node.left);let t=e%4;this.onInput({target:{value:"".padStart(4-t," ")}})}onBackTab(){const e=(e,t)=>{let i=/[^ ]+/;for(;t;){e=e.nextNode;let n=i.exec(e.text),r=u.Util.cloneCodeRenderNode(e);if(n)r.text=r.text.slice(t),t=0;else{let e=Math.min(r.text.length,t);r.text=r.text.slice(e),t-=e}this.modification.push({current:r,origin:e})}};if(this.hasSelection()){let t,i,n=!0,r=this.getSelectionVertex();u.Util.nodeLinkedListUntil.forEach(r[0].source,(r=>{if(n){let s=u.Util.getLineStart(r),o=u.Util.getRowIndent(s),a=s.prevNode;t||(t=s),i=Math.min(o%4||4,o),e(a,i),n=!1}else r.lineEnd&&(n=!0)}),r[1].source),this.initOperation(),this.pointer.col=Math.max(this.pointer.col-i,0),this.selection.from.col=Math.max(this.selection.from.col-i,0),this.selection.to.col=this.pointer.col,this.refreshCode(t,r[1].source)}else{let t=u.Util.getLineStart(this.pointer.node.source),i=u.Util.getRowIndent(this.pointer.node.source),n=t.prevNode,r=Math.min(i%4||4,i);e(n,r),this.initOperation(),this.pointer.col=Math.max(this.pointer.col-r,0),this.refreshCode(t,this.pointer.node.source.nextNode)}}onArrowUp(e){if(this.hintInfo.hintItems.length)return this.hintInfo.focus=Math.max(0,this.hintInfo.focus-1),void this.forceUpdate();if(this.pointer.node&&1!==this.pointer.row){this.forceVisible();let e=u.Util.matchPosition(u.Util.getLineStart(u.Util.getLastEnd(this.pointer.node.source)),this.pointer.len);this.pointer.row--,this.pointer.node=new p.EdittingNode(e.node,this.pointer.col-e.node.col),this.pointer.col=e.col,this.pointer.len=e.charLen,this.forceUpdate()}}onArrowDown(e){if(this.hintInfo.hintItems.length)return this.hintInfo.focus=Math.min(this.hintInfo.hintItems.length-1,this.hintInfo.focus+1),void this.forceUpdate();if(this.pointer.node&&this.pointer.row!==this.renderNodeHead.row){this.forceVisible();let e=u.Util.matchPosition(u.Util.getNextStart(this.pointer.node.source),this.pointer.len);this.pointer.row++,this.pointer.node=new p.EdittingNode(e.node,this.pointer.col-e.node.col),this.pointer.col=e.col,this.pointer.len=e.charLen,this.forceUpdate()}}onArrowLeft(e){if(this.pointer.node&&(1!==this.pointer.row||0!==this.pointer.col)){this.forceVisible();let t,i=this.pointer.node.source;e.preventDefault(),0===this.pointer.col&&i.id!==this.renderNodeHead.id?(t=this.nodeLinkedListUtil.findReversely(i.prevNode,(e=>e.lineEnd)),this.pointer.row--,this.pointer.col=t.col+t.text.length):(this.pointer.col--,t=i.prevNode),i.row!==this.pointer.row||i.col>this.pointer.col?this.pointer.node=new p.EdittingNode(t,this.pointer.col-t.col):this.pointer.node=new p.EdittingNode(i,this.pointer.col-i.col),this.updateCharLength(),this.forceUpdate()}}onArrowRight(){if(this.pointer.node){this.forceVisible();let e=this.pointer.node.editting,t=e.nextNode;if(e.lineEnd&&this.pointer.col-e.col===e.text.length){if(t.id===this.renderNodeHead.id)return;this.pointer.row++,this.pointer.col=0}else this.pointer.col++;e.row!==this.pointer.row?this.pointer.node=new p.EdittingNode(t,0):e.col+e.text.length<this.pointer.col?this.pointer.node=new p.EdittingNode(t,1):(this.pointer.node=new p.EdittingNode(this.pointer.node.source,this.pointer.col-e.col),this.pointer.node.editting=e),this.updateCharLength(),this.forceUpdate()}}onFocusNextSearchResult(){this.searchResult[this.focusedSearchResult].focused=!1,this.focusedSearchResult++,this.focusedSearchResult>=this.searchResult.length&&(this.focusedSearchResult=0),this.searchResult[this.focusedSearchResult].focused=!0,this.forceUpdate()}onFocusPrevSearchResult(){this.searchResult[this.focusedSearchResult].focused=!1,this.focusedSearchResult--,this.focusedSearchResult<0&&(this.focusedSearchResult=this.searchResult.length-1),this.searchResult[this.focusedSearchResult].focused=!0,this.forceUpdate()}applyModification(e){let t=e&&e.slice()||[];return this.modification.forEach((i=>{let{current:n,origin:r}=i;n instanceof Array?(u.Util.nodeLinkedListUntil.reInsert(n[0]),u.Util.nodeLinkedListUntil.reInsert(n[1]),r[0].boundary.nextNode.id===r[0].id&&(r[0].boundary.nextNode=n[0]),r[1].boundary.nextBoundary.prevNode.id===r[1].id&&(r[1].boundary.nextBoundary.prevNode=n[1]),r[0].id===e[0].id&&(t[0]=n[0]),r[1].id===e[1].id&&(t[1]=n[1])):(u.Util.nodeLinkedListUntil.reInsert(n),r.boundary.nextNode.id===r.id&&(r.boundary.nextNode=n),r.boundary.nextBoundary.prevNode.id===r.id&&(r.boundary.nextBoundary.prevNode=n),e.forEach(((e,i)=>{r.id===e.id&&(t[i]=n)})))})),t}removeModification(){for(let e=this.modification.length-1;e>=0;e--){let{current:t,origin:i}=this.modification[e];i instanceof Array?(u.Util.nodeLinkedListUntil.reInsert(i[0]),u.Util.nodeLinkedListUntil.reInsert(i[1]),i[0].boundary.nextNode.id===t[0].id&&(i[0].boundary.nextNode=i[0]),i[1].boundary.nextBoundary.prevNode.id===t[1].id&&(i[1].boundary.nextBoundary.prevNode=i[1])):(u.Util.nodeLinkedListUntil.reInsert(i),i.boundary.nextNode.id===i.id&&(i.boundary.nextNode=i),i.boundary.nextBoundary.prevNode.id===i.id&&(i.boundary.nextBoundary.prevNode=i))}}initOperation(){this.curOperation=new m.HistoryOperation,this.curOperation.row=this.pointer.row,this.curOperation.col=this.pointer.col,this.curOperation.pointerNode=this.pointer.node.source,this.curOperation.selection=this.selection?u.Util.cloneSelection(this.selection):null}autoEnwrap(e){if(!g.ENWRAP_OPEN.includes(e))return!1;if(this.hasSelection()){this.initOperation();let t=this.selection.from,i=this.selection.to;return"left"===this.selection.direction&&(t=this.selection.to,i=this.selection.from),t.editting.text=u.Util.insertText(t.editting.text,t.col-t.editting.col,e),t.col++,t.len+=u.Util.charSize,this.pointer.col++,this.pointer.len+=u.Util.charSize,t.editting.id===i.editting.id&&(i.col++,i.len+=u.Util.charSize),i.editting.text=u.Util.insertText(i.editting.text,i.col-i.editting.col,g.ENWRAP_CLOSE_MAP[e]),this.resetSelectionVertex(),this.refreshCode(t.source,i.source),!0}return this.pointer.node.right=g.ENWRAP_CLOSE_MAP[e]+this.pointer.node.right,!1}updateSelectionVetexNode(e,t){u.Util.nodeLinkedListUntil.forEach(e,(e=>{this.selection.from.row===e.row&&this.selection.from.col>=e.col&&this.selection.from.col<=e.col+e.text.length&&(this.selection.from.source=e,this.selection.from.editting=u.Util.cloneCodeRenderNode(e)),this.selection.to.row===e.row&&this.selection.to.col>=e.col&&this.selection.to.col<=e.col+e.text.length&&(this.selection.to.source=e,this.selection.to.editting=u.Util.cloneCodeRenderNode(e))}),t),this.selection.to.len=u.Util.getCharLenFromRowHead(this.selection.to.source,this.selection.to.col),this.selection.from.len=u.Util.getCharLenFromRowHead(this.selection.from.source,this.selection.from.col)}getSelectionVertex(e){if(this.selection){let t=this.selection.from,i=this.selection.to;return"left"===this.selection.direction&&(t=this.selection.to,i=this.selection.from),e?[t[e],i[e]]:[t,i]}return[]}onInput(e,t=!1){let i=t?this.clipboard:e.target.value,n=[];if(!t&&this.autoEnwrap(i))return;this.mergeEdit=u.Util.breakPoints.includes(i)?0:[2,1].includes(this.mergeEdit)?2:1,this.hasSelection()?(this.doDeleteSelection(),n=this.getSelectionVertex("source")):this.initOperation(),this.pointer.node.input=i,this.pointer.node.update(),this.modification.push({current:this.pointer.node.editting,origin:this.pointer.node.source});let r=i.split("\r\n");r.length>1?(this.pointer.row+=r.length-1,this.pointer.col=r[r.length-1].length):this.pointer.col+=r[0].length,e&&(e.target.value=""),this.getCodeHints(),this.refreshCode(...n)}pushOperation(){if(!this.curOperation)return this.patchOperation=this.curOperation=null;let e=this.historyOperations[this.historyOperations.length-1];e&&this.mergeEdit>1?e.mergeEdit(this.curOperation):this.historyOperations.push(this.curOperation),this.patchOperation=this.curOperation=null}onEnter(){if(this.hintInfo.hintItems.length)return this.onSelectedHintItem(this.hintInfo.hintItems.find(((e,t)=>t===this.hintInfo.focus)));this.mergeEdit=0,this.forceVisible();let e=this.pointer.node,t=this.pointer.node.source,i=u.Util.cloneAndUpdateRenderNode(t,{text:e.left,lineEnd:!0}),n=u.Util.cloneAndUpdateRenderNode(t,{text:u.Util.getLineStartSpace(t),lineEnd:!1}),r=u.Util.cloneAndUpdateRenderNode(t,{text:e.right});u.Util.nodeLinkedListUntil.linkAfter(i,n),u.Util.nodeLinkedListUntil.linkAfter(n,r),this.modification.push({current:[i,r],origin:[t,t]}),this.initOperation(),this.pointer.row++,this.pointer.col=n.text.length,this.pointer.len=u.Util.measureCharLen(n.text),this.refreshCode()}resetInput(){this.pointer.node.left+=this.pointer.node.input,this.inputBoxRef.current.value=this.pointer.node.input=""}componentWillReceiveProps(e){this.code=e.code,this.renderCode(this.code)}componentDidMount(){this.operations=[{name:"复制",iconClass:"fa-solid fa-copy",shortCut:"Ctrl + C",onClick:()=>{this.onCopy(),this.closeMenu()}},{name:"粘贴",iconClass:"fa-solid fa-paste",shortCut:"Ctrl + V",onClick:()=>{this.onPaste(),this.closeMenu()}},{name:"剪切",iconClass:"fa-solid fa-scissors",shortCut:"Ctrl + X",onClick:()=>{this.onCut(),this.closeMenu()}}],this.context.events.currentFileChange.subscribe((e=>{e.headRenderNode?(this.ast=e.ast,this.renderNodeHead=this.headNode=e.headRenderNode,this.forceUpdate()):this.refresh(e)})),this.context.events.refresh.subscribe((e=>{this.refresh(e)})),this.context.events.search.subscribe((()=>{this.isSearching=!0,this.forceUpdate()}))}refresh(e){this.context.api.getFile(e.path).then((e=>{this.code=e.data.data,this.renderCode(this.code)}))}getNewFile(e){}setCursorFlash(){this.terminateFlash&&this.terminateFlash();let e=!1,t=()=>{setTimeout((()=>{e||(this.setState({hideCursor:!this.state.hideCursor}),t())}),500)};return t(),function(){e=!0}}stringify(e,t){let i=o.CodeRenderer.stringify.apply(o.CodeRenderer,this.applyModification([e,t]));return this.removeModification(),i}refreshCode(e,t){if(!this.pointer)return;let i,n=this.pointer.node.source,{curLeftNode:r,curRightNode:s,curLeftBoundary:d,curRightBoundary:c}=u.Util.riseToSameBlock(e||n,t||n.nextNode),h=r.block,p=this.stringify(r,s),{startIndex:f,endIndex:x}=u.Util.getIndexs(d,c,h.body),m=new l.JavascriptAstParsser(p).parse(!1);if(this.curOperation&&(this.curOperation.index=f,this.curOperation.block=h,this.curOperation.hisRenderNodeHead=r,this.curOperation.hisRenderNodeTail=s),this.curOperation?(this.curOperation.currentAstNodes=m.topLevelBlock.body,this.curOperation.prevAstNodes=null===f?[]:h.body.splice(f,s.id!==r.id?x-f:1,...m.topLevelBlock.body)):null!==f&&h.body.splice(f,s.id!==r.id?x-f:1,...m.topLevelBlock.body),this.reAnalyze(h),i=new o.CodeRenderer(p,m).render(h).nextNode,u.Util.boundaryLinkedListUtil.unlinked(i.prevNode.boundary),u.Util.identifierLinkedListUtil.unlinked(i.prevNode),u.Util.nodeLinkedListUntil.unlinked(i.prevNode),this.insertRenderNodes(i,r.prevNode,s.nextNode),p||i.prevNode.lineEnd||C.CodeRenderNodeUtil.unlinkNode(i),this.headNode.prevNode.lineEnd){let e=new a.CodeRenderNode("");e.boundary=this.headNode.prevNode.boundary,e.scope=this.headNode.prevNode.scope,e.block=this.headNode.prevNode.block,u.Util.nodeLinkedListUntil.insertAfter(this.headNode.prevNode,e),this.headNode.boundary.prevNode=e}this.patchOperation&&this.patchOperation(),this.pushOperation(),this.patchOperation=this.curOperation=null,i&&this.checkIdentifier(u.Util.nodeLinkedListUntil.find(i,(e=>e.identifier&&e.block))),this.modification=[],this.forceVisible(),this.forceUpdate((()=>{let e=r.prevNode;this.updatePointer(e),this.hasSelection()&&(this.updateSelectionVetexNode(e,s.nextNode),this.resetSelectedZone()),this.isSearching&&this.onSearch(),this.forceUpdate()}))}insertRenderNodes(e,t,i){e?C.CodeRenderNodeUtil.insertNodes(e,e.prevNode,t,i):C.CodeRenderNodeUtil.linkNodes(t,i)}forceVisible(){this.forcePointerVisible=!0,this.forceVisible.timer&&clearTimeout(this.forceVisible.timer),this.forceVisible.timer=setTimeout((()=>{this.forcePointerVisible=!1,this.forceVisible.timer=null}),200)}reAnalyze(e){(new d.JavascriptScopeAnalyzer).analyze(e,e.scope.parent)}checkIdentifier(e){if(e){let t=t=>{if(!t.block||t.block.depth<e.block.depth)return!0;t.checkScope&&o.CodeRenderer.checkScope(t)};u.Util.identifierLinkedListUtil.findReversely(e,t),u.Util.identifierLinkedListUtil.find(e.nextIdentifier,t)}}updatePointer(e){let t=u.Util.nodeLinkedListUntil.find(e,(e=>e.row===this.pointer.row&&e.col<=this.pointer.col&&e.col+e.text.length>=this.pointer.col));this.pointer.node=new p.EdittingNode(t,this.pointer.col-t.col),this.updateCharLength()}renderCode(e){if(null==e)return;let t,i,n=new f.Scope;n.addDefinitions(x.getGlobalDefinitions(n)),n.addDefinition(x.getConsoleDefinition(n)),this.ast=new l.JavascriptAstParsser(e).parse(),this.ast.topLevelBlock.scope.parent=n,this.renderNodeHead=t=new o.CodeRenderer(e,this.ast).render(),i=new c.LinkedListUtil("prevNode","nextNode").find(t,(e=>e.identifier)),u.Util.identifierLinkedListUtil.forEach(i,(e=>e.checkScope&&o.CodeRenderer.checkScope(e))),this.headNode=t,this.context.store.currentFile.headRenderNode=this.headNode,this.context.store.currentFile.ast=this.ast,this.forceUpdate()}onBlur(){}hasSelection(){return this.selection&&(this.selection.from.row!==this.selection.to.row||this.selection.from.col!==this.selection.to.col)}deleteSelection(){return this.hasSelection()?(this.doDeleteSelection(),this.updateCharLength(),this.setState({hideCursor:!1}),this.terminateFlash=this.setCursorFlash(),this.refreshCode(...this.getSelectionVertex("source")),!0):(this.selection=null,!1)}doDeleteSelection(){let e=this.selection.from,t=this.selection.to;"left"===this.selection.direction&&(e=this.selection.to,t=this.selection.from),this.mergeEdit=0,this.initOperation(),e.editting.id===t.editting.id?e.editting.text=e.editting.text.slice(0,e.col-e.editting.col)+e.editting.text.slice(t.col-t.editting.col):(u.Util.nodeLinkedListUntil.linkAfter(e.editting,t.editting),e.editting.text=e.editting.text.slice(0,e.col-e.editting.col),t.editting.text=t.editting.text.slice(t.col-t.editting.col)),this.modification.push({current:[e.editting,t.editting],origin:[e.source,t.source]}),this.bgBlock1Style={},this.bgBlock2Style={};let i=e.col-e.editting.col;return this.pointer={row:e.row,col:e.col,node:new p.EdittingNode(e.source,i),len:null},this.pointer.node.editting=e.editting,this.pointer.node.left=e.editting.text.slice(0,i),this.pointer.node.right=e.editting.text.slice(i),this.selection=null,{left:e,right:t}}onCopy(){if(!this.hasSelection())return;let e=this.getSelectionVertex(),t=e[0],i=e[1];if(t.editting.id===i.editting.id)this.clipboard=t.editting.text.slice(t.col-t.editting.col,i.col-i.editting.col);else{let e=t.editting.text.slice(t.col-t.editting.col),n=i.editting.text.slice(0,i.col-i.editting.col);t.editting.nextNode.id===i.editting.id?this.clipboard=e+n:this.clipboard=e+o.CodeRenderer.stringify(t.editting.nextNode,i.editting.prevNode)+n}}onCut(){if(this.hasSelection())this.onCopy(),this.deleteSelection();else{let e=u.Util.getLineStart(this.pointer.node.source),t=u.Util.nodeLinkedListUntil.find(e,(e=>e.lineEnd||e.nextNode.isHead)),i=u.Util.cloneCodeRenderNode(t),n=u.Util.cloneCodeRenderNode(e);u.Util.nodeLinkedListUntil.linkAfter(n,i),i.lineEnd=!1,n.lineEnd=!1,i.text="",n.text="",this.initOperation(),this.pointer.col=0,t.nextNode.isHead&&(this.pointer.row=Math.max(0,this.pointer.row-1)),this.modification.push({current:[n,i],origin:[e,t]}),this.refreshCode(e,t)}}onPaste(){this.onInput(null,!0)}onClick(e){}onMousedown(e,t){this.renderNodeHead&&(this.closeHintBox(),0===t.button&&(t.preventDefault(),t.stopPropagation(),e=e||this.headNode.prevNode,this.unSetSelectedZone(),this.isSelecting=!0,this.resetPointer(e,t.nativeEvent.target.offsetLeft+t.nativeEvent.offsetX),this.setState({hideCursor:!1}),this.terminateFlash=this.setCursorFlash(),this.focusInput(),this.selection={from:{row:this.pointer.row,col:this.pointer.col,source:this.pointer.node.source,editting:u.Util.cloneCodeRenderNode(this.pointer.node.source),len:this.pointer.len},to:{row:this.pointer.row,col:this.pointer.col,source:this.pointer.node.source,editting:u.Util.cloneCodeRenderNode(this.pointer.node.source),len:this.pointer.len},direction:"right"},this.forceUpdate()))}onMouseup(e){this.isSelecting=!1,2===e.button&&this.setState({menuVisible:!0,menuPos:{left:e.clientX+10,top:e.clientY+10}})}onMousemove(e,t){this.isSelecting&&(t.stopPropagation(),e=e||this.headNode.prevNode,this.resetPointer(e,t.nativeEvent.target.offsetLeft+t.nativeEvent.offsetX),this.updateSelectedZone(),this.forceUpdate())}updateSelectedZone(){if(!this.selection)return;let e=e=>t=>{var i;if(t.id===this.pointer.node.source.id)return!0;let n=e(t);t.style={background:n,color:t.style&&t.style.color},n?(t.displayText=u.Util.showUpSpace(t),t.selected=!0):(t.displayText=[{text:t.text,style:{color:null===(i=t.style)||void 0===i?void 0:i.color}}],t.selected=!1)};"left"===this.selection.direction?u.Util.isPositionGreater(this.selection.to,this.pointer)?u.Util.nodeLinkedListUntil.find(this.selection.to.source,e((e=>u.Util.isPositionGreater(this.selection.from.source,e)?E:null))):u.Util.nodeLinkedListUntil.findReversely(this.selection.to.source,e((e=>E))):u.Util.isPositionGreater(this.selection.to,this.pointer)?this.nodeLinkedListUtil.find(this.selection.to.source,e((e=>E))):u.Util.nodeLinkedListUntil.findReversely(this.selection.to.source,e((e=>u.Util.isPositionGreater(e,this.selection.from.source)?E:null))),this.selection.to={row:this.pointer.row,col:this.pointer.col,source:this.pointer.node.source,editting:u.Util.cloneCodeRenderNode(this.pointer.node.source),len:this.pointer.len},this.selection.direction=u.Util.isPositionGreater(this.selection.from,this.selection.to)?"right":"left",this.resetSelectionVertex()}resetSelectedZone(){if(!this.hasSelection())return;const e=this.getSelectionVertex("source");u.Util.nodeLinkedListUntil.forEach(e[0],(t=>{t.id!==e[0].id&&t.id!==e[1].id&&(t.style=Object.assign({},t.style,{background:E}),t.displayText=u.Util.showUpSpace(t),t.selected=!0)}),e[1]),this.resetSelectionVertex()}unSetSelectedZone(){if(!this.selection||this.selection.from.row===this.selection.to.row&&this.selection.from.col===this.selection.to.col)return;let e=this.selection.direction,t="left"===e?this.selection.to.source:this.selection.from.source,i="left"===e?this.selection.from.source:this.selection.to.source;u.Util.nodeLinkedListUntil.find(t,(e=>{var t;if(e.style={color:null===(t=e.style)||void 0===t?void 0:t.color},e.displayText=[{text:e.text,style:e.style}],e.selected=!1,e.id===i.id)return!0})),this.bgBlock1Style={},this.bgBlock2Style={},this.selection=null}showUpVertextSpace(){let e=this.getSelectionVertex();if(e[0].source.id===e[1].source.id){let t=e[0].source;t.displayText=u.Util.showUpSpace(t,e[0].col-t.col,e[1].col-t.col)}else{let t=e[0].source,i=e[1].source;t.displayText=u.Util.showUpSpace(t,e[0].col-t.col),i.displayText=u.Util.showUpSpace(i,0,e[1].col-i.col)}}resetSelectionVertex(){if(!this.selection)return;let e=this.selection.from.source,t=this.selection.to.source,i=this.selection.direction;if(e.style={color:e.style.color},t.style={color:t.style.color},e.id===t.id)this.bgBlock2Style={},this.bgBlock1Style={left:"left"===i?this.selection.to.len+80+"px":this.selection.from.len+80+"px",top:24*(this.selection.to.row-1)+"px",height:"24px",background:E,width:"left"===i?u.Util.measureCharLen(e.text.slice(this.selection.to.col-e.col,this.selection.from.col-e.col))+"px":u.Util.measureCharLen(e.text.slice(this.selection.from.col-e.col,this.selection.to.col-e.col))+"px"};else{let n=this.selection.from,r=this.selection.to;e.style={color:e.style.color},t.style={color:t.style.color},"left"===i&&(n=this.selection.to,r=this.selection.from);let s=u.Util.measureCharLen(r.source.text.slice(0,r.col-r.source.col));this.bgBlock1Style={left:n.len+80+"px",top:24*(n.row-1)+"px",height:"24px",background:E,width:u.Util.measureCharLen(n.source.text.slice(n.col-n.source.col))+"px"},this.bgBlock2Style={left:r.len-s+80+"px",top:24*(r.row-1)+"px",height:"24px",width:s+"px",background:E}}this.showUpVertextSpace()}resetPointer(e,t){this.pointer||(this.pointer={row:null,col:null,len:null,node:null});let i=u.Util.measureOffset(t,e.text);this.setPointerLocation(e.row,e.col+i),this.pointer.node=new p.EdittingNode(e,i),this.updateCharLength()}setPointerLocation(e,t){this.pointer.row=e,this.pointer.col=t}updateCharLength(){let e=this.applyModification([this.pointer.node.source])[0];this.pointer.len=u.Util.getCharLenFromRowHead(e,this.pointer.col),this.removeModification()}focusInput(){this.inputBoxRef.current.focus()}getStatic(e,t){return r.createElement("div",{className:"code-node-container",style:e.style,onMouseDown:t=>{this.onMousedown(e,t)},onMouseMove:t=>{this.onMousemove(e,t)}},e.displayText.map((t=>r.createElement("span",{className:["code-node",e.err?"wavy-line-decoration":"",!e.err&&e.unuse?"unuse-node":""].join(" "),style:t.style||{},dangerouslySetInnerHTML:{__html:t.text.replace(/\s/g,"&nbsp;")}}))),e.searchResult.map((e=>r.createElement("div",{className:"search-result-div",style:{left:e.left,background:e.node.selected?"#665350":e.focused?"#515C6A":null,top:0,bottom:0,width:e.len}}))),e.err?r.createElement(s.ErrorMsgBlock,{msg:e.msg,className:t>5?" up-positioin":" down-position"}):"")}isEdittingNode(e){var t,i;return(null===(i=null===(t=this.pointer)||void 0===t?void 0:t.node)||void 0===i?void 0:i.source.id)===e.id}getNodeElements(){var e;let t,i=this.headNode,n=this.headNode,s=/[^ ]+/,o=0,a=!1,l=0,d=[],c=0,h=[],p=0,f=e=>{for(let t=0;t<=e;t++){let e={left:u.Util.charSize*t*4+80+"px"};d.push(r.createElement("div",{className:"tap-line",style:e}))}},x=()=>{let e=[];do{if(!a&&i.text.length){let e=s.exec(i.text);e?(o+=e.index,a=!0):o+=i.text.length}if(i.row=p,i.col=t,e.push(this.getStatic(i,p)),t+=i.text.length,i=i.nextNode,i.prevNode.lineEnd){if(o&&a){let e=o%4;f((o-e)/4),e||d.pop()}else a||f(c-1);c=d.length;break}}while(i&&i.id!==n.id);return e};do{let n;t=0,p++,o=0,a=!1,l=0,d=[];let s={background:p===(null===(e=this.searchResult[this.focusedSearchResult])||void 0===e?void 0:e.node.row)?"#272727":null};h.push(r.createElement("li",{className:["flex flex-v-center row-item",!this.hasSelection()&&this.pointer&&this.pointer.row===p?"selected-row":""].join(" "),onMouseMove:e=>{this.onMousemove(n,e)},onMouseDown:e=>{this.onMousedown(n,e)}},r.createElement("div",{className:"line-index"},r.createElement("span",null,p)),r.createElement("div",{className:"line-content",style:s},x()),d)),n=i.prevNode}while(i&&i.id!==n.id);return h}getCodeHints(){this.pointer.node.source.text&&(this.hintInfo.hintItems=u.Util.sortDefinitions(u.Util.MatchDefinition(this.pointer.node.source))),this.forceUpdate()}onSearch(){this.clearSearch();let e="",t=this.searchBoxRef.current.value.toLowerCase(),i=t.split("\n"),n=t.length,r=[];u.Util.nodeLinkedListUntil.forEach(this.headNode,(s=>{if(e+=s.text.toLowerCase(),s.lineEnd&&(e+="\n",r.push(s)),e.length>=n)if(e.indexOf(t)>-1){let t=e.split("\n"),n=[];t[t.length-1]||t.pop(),r.length&&r[r.length-1].id===s.id||r.push(s);for(let e=i.length-1;e>-1;e--){let s=t.pop(),o=i[e],a=r.pop(),l=s.length-a.text.length,d=s.indexOf(o),c=n.push({index:d,content:s,searchStr:o,node:a,focused:!1,len:u.Util.measureCharLen(o),left:-u.Util.measureCharLen(o.slice(0,l-d))});a.searchResult.push(n[c-1])}for(;n.length;)this.searchResult.push(n.pop());let o=this.searchResult[this.searchResult.length-1];e=o.content.slice(o.index+o.searchStr.length),r=e&&s.lineEnd?[s]:[]}else e=e.slice(-(n-1))})),this.searchResult.length&&(this.searchResult[0].focused=!0,this.focusedSearchResult=0),this.forceUpdate()}clearSearch(){this.searchResult.forEach((e=>{e.node.searchResult=[]})),this.searchResult=[],this.focusedSearchResult=0}onSelectedHintItem(e){this.mergeEdit=0;let t=e.definition.identifier;this.initOperation(),this.pointer.col-=this.pointer.node.input.length+this.pointer.node.left.length,this.pointer.node.editting.text&&"."!==this.pointer.node.editting.text&&(this.pointer.node.left=this.pointer.node.right=""),this.pointer.node.input=t,this.pointer.node.update(),this.modification.push({current:this.pointer.node.editting,origin:this.pointer.node.source});for(let e=0,t=this.pointer.node.editting.text.length;e<t;e++)this.onArrowRight();this.closeHintBox(),this.refreshCode()}closeHintBox(){this.hintInfo.hintItems=[],this.hintInfo.focus=0}renderCodeHints(){return r.createElement("div",{className:"code-hints",onMouseDown:e=>{e.stopPropagation()},style:{left:this.pointer.len+80+"px",top:24*this.pointer.row}},r.createElement("ul",null,(()=>this.hintInfo.hintItems.map(((e,t)=>r.createElement("li",{className:this.hintInfo.focus===t?"focus":"",onClick:this.onSelectedHintItem.bind(this,e)},r.createElement("span",null,e.textLeft),r.createElement("span",{className:"match-text"},e.text),r.createElement("span",null,e.textRight)))))()))}onCloseSearchBox(){this.clearSearch(),this.isSearching=!1,this.forceUpdate()}closeMenu(){this.setState({menuVisible:!1})}render(){var e;return r.createElement("div",{className:"code-snippet",onMouseUp:e=>{this.onMouseup(e)},onMouseMove:e=>{this.onMousemove(null,e)},onMouseDown:e=>{this.onMousedown(null,e)}},this.headNode?r.createElement("ul",{onMouseMove:e=>e.stopPropagation()},this.getNodeElements()):"",(null===(e=this.hintInfo.hintItems)||void 0===e?void 0:e.length)?this.renderCodeHints():"",r.createElement("input",{className:"code-input-box",ref:this.inputBoxRef,onInput:this.onInput.bind(this),type:"text"}),this.pointer?(()=>r.createElement("div",{className:["cursor",this.state.hideCursor?"":"visible",this.forcePointerVisible?"force-visible":""].join(" "),ref:this.cursorRef,style:{left:this.pointer.len+80+"px",top:24*(this.pointer.row-1)},onMouseMove:e=>e.stopPropagation()}))():"",r.createElement("div",{className:"bg-block1 bg-block",style:this.bgBlock1Style}),r.createElement("div",{className:"bg-block2 bg-block",style:this.bgBlock2Style}),this.isSearching?r.createElement("div",{className:"search-box",onMouseDown:e=>e.stopPropagation()},r.createElement("textarea",{ref:this.searchBoxRef}),r.createElement("button",{className:"controll-btn",onClick:this.onSearch.bind(this)},r.createElement("i",{className:"fa-solid fa-magnifying-glass"}),r.createElement("span",null,"搜索")),r.createElement("i",{className:"fa-solid fa-arrow-down icon-btn",onClick:this.onFocusNextSearchResult.bind(this)}),r.createElement("i",{className:"fa-solid fa-arrow-up icon-btn",onClick:this.onFocusPrevSearchResult.bind(this)}),r.createElement("i",{className:"fa-solid fa-xmark icon-btn",onClick:this.onCloseSearchBox.bind(this)})):null,this.state.menuVisible&&r.createElement(S.OperationMenu,{menuPosition:this.state.menuPos,operations:this.operations,onCoverClick:this.closeMenu.bind(this)}))}}n([y.MergeCall(100)],b.prototype,"getCodeHints",null),t.CodeSnippet=b,b.contextType=N.MyContext},2215:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EdittingNode=void 0;const n=i(5285);t.EdittingNode=class{constructor(e,t){this.source=e,this.input="",this.left=e.text.slice(0,t),this.right=e.text.slice(t),this.editting=n.Util.cloneCodeRenderNode(e)}update(){this.editting.text=this.left+this.input+this.right}}},7288:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorMsgBlock=void 0;const n=i(7294);i(7019);class r extends n.Component{constructor(e){super(e)}render(){return n.createElement("div",{className:"error-msg-block"+this.props.className},this.props.msg)}}t.ErrorMsgBlock=r},1012:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ControllBar=void 0;const n=i(7294),r=i(2274);i(9552);class s extends n.Component{constructor(e){super(e),this.state={onSaveBtnText:"保存(ctrl+s)"}}onSave(){let e=this.context.store.currentFile;e&&(this.setState({onSaveBtnText:"保存中..."}),e.stringifyAsyn().then((t=>this.context.api.save({path:e.path,content:t}))).then((e=>{200===e.data.status&&this.setState({onSaveBtnText:"保存(ctrl+s)"})})))}onPlay(){this.context.api.play("project1").then((e=>{200===e.data.status&&window.open(e.data.data)}))}search(){this.context.events.search.next()}onReresh(){this.context.store.currentFile&&this.context.events.refresh.next(this.context.store.currentFile)}render(){return n.createElement("div",{className:"controll-bar"},n.createElement("button",{className:"controll-btn",onClick:this.onSave.bind(this)},n.createElement("i",{className:"fa-solid fa-save"}),n.createElement("span",null,this.state.onSaveBtnText)),n.createElement("button",{className:"controll-btn",onClick:this.onReresh.bind(this)},n.createElement("i",{className:"fa-solid fa-refresh"}),n.createElement("span",null,"刷新(ctrl+r)")),n.createElement("button",{className:"controll-btn",onClick:this.search.bind(this)},n.createElement("i",{className:"fa-solid fa-search"}),n.createElement("span",null,"搜索(ctrl+f)")))}}t.ControllBar=s,s.contextType=r.MyContext},8942:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DirectoryComponent=void 0;const n=i(7294),r=i(2274),s=i(6056),o=i(660);i(8255);const a=i(3640);class l extends n.Component{constructor(e){super(e),this.inputRef=n.createRef(),this.inputRef2=n.createRef(),this.id=null,this.askForNameResolveFn=null,this.rightClickItem=null,this.rightClickDirectory=null,this.unFoldItemMap=new Map,this.clipbord=null,this.operations=[],this.state={rootDirectory:new s.Directory("","",null,[]),selected:null,isNameInputBoxVisible:!1,isNameInputBox2Visible:!1,menuPosition:{left:0,top:0},isMenuVisible:!1}}onDirectoryNameClick(e,t){this.unFoldItemMap.set(e.path,!this.unFoldItemMap.get(e.path)),this.context.store.currentDir=e,this.setState({selected:e.path})}onCreateFile(){let e=this.rightClickDirectory||this.context.store.currentDir;this.setState({isMenuVisible:!1}),this.askForName().then((t=>{this.closeMenuPanel();let i=`${e.path}/${t}`;this.context.functions.showSideBarLoading(),this.context.api.createFile({path:i}).then((e=>{this.context.functions.hideSideBarLoading(),200===e.data.status&&this.updateCurrentFileAndDirRef(i).then((e=>{200===e.status&&this.context.events.refresh.next(this.context.store.currentFile)}))})).catch((e=>this.context.functions.hideSideBarLoading()))}))}onCreateDir(){let e=this.rightClickDirectory||this.context.store.currentDir;this.setState({isMenuVisible:!1}),this.askForName().then((t=>{this.closeMenuPanel();let i=`${e.path}/${t}`;this.context.functions.showSideBarLoading(),this.context.api.createDir({path:i}).then((t=>{this.context.functions.hideSideBarLoading(),200===t.data.status&&this.updateCurrentFileAndDirRef(e.path).then((()=>{this.setState({selected:i})}))})).catch((e=>{this.context.functions.hideSideBarLoading()}))})),this.context.events.askForName.next()}onDelete(e){let t=e||this.rightClickItem;this.closeMenuPanel(),this.context.api.delete({path:t.path}).then((e=>{200===e.data.status&&this.updateCurrentFileAndDirRef(this.context.store.currentFile&&this.context.store.currentFile.path!==t.path?this.context.store.currentFile.path:this.context.store.currentDir.path)}))}onCopy(){this.clipbord={item:this.rightClickItem,isCut:!1},this.closeMenuPanel()}onPaste(){let e=`${this.rightClickDirectory.path}/${this.clipbord.item.name}`;this.context.api.paste({origin:this.clipbord.item.path,target:e}).then((e=>200===e.data.status&&this.clipbord.isCut?this.context.api.delete({path:this.clipbord.item.path}):e)).then((t=>{200===t.data.status&&(this.clipbord.item instanceof o.FileObject?this.updateCurrentFileAndDirRef(e).then((e=>{200===e.status&&this.context.events.refresh.next(this.context.store.currentFile)})):this.updateCurrentFileAndDirRef(this.rightClickDirectory.path).then((t=>{200===t.status&&this.setState({selected:e})}))),this.clipbord.isCut&&(this.clipbord=null),this.closeMenuPanel()}))}onCut(){this.clipbord={item:this.rightClickItem,isCut:!0},this.closeMenuPanel()}onRename(){this.tobeRenamedItem=this.rightClickItem,this.askForName2().then((e=>{let t=`${this.tobeRenamedItem.parent.path}/${e}`;this.context.api.rename({origin:this.tobeRenamedItem.path,target:t}).then((e=>{var i,n;200===e.data.status&&(this.tobeRenamedItem.path===(null===(i=this.context.store.currentFile)||void 0===i?void 0:i.path)?this.updateCurrentFileAndDirRef(t):this.updateCurrentFileAndDirRef((null===(n=this.context.store.currentFile)||void 0===n?void 0:n.path)||this.context.store.currentDir.path))}))}))}updateCurrentFileAndDirRef(e){return this.context.functions.refreshDir().then((t=>(200===t.data.status&&(this.context.functions.updateCurrentFileAndDirRef(e),this.context.store.currentDir&&this.unFoldItemMap.set(this.context.store.currentDir.path,!0),this.setState({rootDirectory:this.context.store.rootDir,selected:e,isNameInputBoxVisible:!1})),t)))}askForName(){return new Promise((e=>{this.askForNameResolveFn=e,this.unFoldItemMap.set((this.rightClickDirectory||this.context.store.currentDir).path,!0),this.setState({isNameInputBoxVisible:!0},(()=>{this.inputRef.current.focus()}))}))}askForName2(){return new Promise((e=>{this.askForNameResolveFn=e,this.setState({isNameInputBox2Visible:!0},(()=>{this.inputRef2.current.focus(),this.inputRef2.current.value=this.rightClickItem.name,this.closeMenuPanel()}))}))}onMouseUp(e,t){2===e.button&&(e.preventDefault(),this.rightClickItem=t,this.rightClickItem instanceof s.Directory?this.rightClickDirectory=this.rightClickItem:this.rightClickDirectory=this.rightClickItem.parent,this.setState({isMenuVisible:!0,menuPosition:{left:e.clientX+10,top:e.clientY+10}}))}gDirectoryTemplate(e){return n.createElement("div",{className:"directory-item"},n.createElement("div",{className:"directory-name",onClick:t=>this.onDirectoryNameClick(e,t),onMouseUp:t=>this.onMouseUp(t,e)},n.createElement("div",{className:["bg-bar",this.state.selected===e.path?"selected":""].join(" ")}),n.createElement("div",{className:"content-wrapper"},n.createElement("i",{className:["fa-solid icon",this.unFoldItemMap.get(e.path)?"fa-angle-down":"fa-angle-right"].join(" ")}),this.state.isNameInputBox2Visible&&this.tobeRenamedItem.path===e.path&&n.createElement("input",{type:"text",ref:this.inputRef2,onBlur:this.onBlur.bind(this),className:"input-file-dir-name"})||n.createElement("span",null,e.name))),n.createElement("div",{className:["directory-children",this.unFoldItemMap.get(e.path)?"":"hidden"].join(" ")},this.state.isNameInputBoxVisible&&(this.rightClickDirectory===e||this.context.store.currentDir===e)&&n.createElement("div",{className:"input-wrapper"},n.createElement("input",{type:"text",ref:this.inputRef,onBlur:this.onBlur.bind(this),className:"input-file-dir-name"})),e.children.map((e=>e instanceof o.FileObject?this.gFileTemplate(e):e instanceof s.Directory?this.gDirectoryTemplate(e):void 0))))}onMenuCoverClick(){this.closeMenuPanel()}closeMenuPanel(){this.setState({isMenuVisible:!1}),this.rightClickDirectory=this.rightClickItem=null}onFileClick(e){this.context.store.currentFile=e,this.context.store.currentDir=e.parent,this.context.events.currentFileChange.next(e),this.setState({selected:e.path})}gFileTemplate(e){return n.createElement("div",{className:"file-item",onClick:()=>{this.onFileClick(e)},onMouseUp:t=>this.onMouseUp(t,e)},n.createElement("div",{className:["bg-bar",this.state.selected===e.path?"selected":""].join(" ")}),n.createElement("div",{className:"content-wrapper"},n.createElement("i",{className:"fa-solid fa-file icon"}),this.state.isNameInputBox2Visible&&this.tobeRenamedItem.path===e.path&&n.createElement("input",{type:"text",ref:this.inputRef2,onBlur:this.onBlur.bind(this),className:"input-file-dir-name"})||n.createElement("span",null,e.name)))}onBlur(e){this.askForNameResolveFn(e.target.value)}componentDidMount(){this.operations=[{name:"创建文件",iconClass:"fa-solid fa-file-circle-plus",shortCut:"",onClick:this.onCreateFile.bind(this)},{name:"创建文件夹",iconClass:"fa-solid fa-folder-plus",onClick:this.onCreateDir.bind(this)},{name:"复制",shortCut:"Ctrl + C",iconClass:"fa-solid fa-copy",onClick:this.onCopy.bind(this)},{name:"剪切",iconClass:"fa-solid fa-scissors",shortCut:"Ctrl + X",onClick:this.onCut.bind(this)},{name:"粘贴",iconClass:"fa-solid fa-paste",shortCut:"Ctrl + V",onClick:this.onPaste.bind(this)},{name:"重命名",iconClass:"fa-solid fa-file-pen",onClick:this.onRename.bind(this)},{name:"删除",iconClass:"fa-solid fa-trash-can",onClick:this.onDelete.bind(this)}],this.context.functions.refreshDir().then((e=>{200===e.data.status&&this.setState({rootDirectory:s.Directory.fromServerData(e.data.data)})}))}render(){return n.createElement("div",{className:"direcory-component"},this.gDirectoryTemplate(this.state.rootDirectory),this.state.isMenuVisible&&n.createElement(a.OperationMenu,{menuPosition:this.state.menuPosition,operations:this.operations,onCoverClick:this.closeMenuPanel.bind(this)}))}}t.DirectoryComponent=l,l.contextType=r.MyContext},6056:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Directory=void 0;const n=i(660);class r{constructor(e,t,i,n){this.path=e,this.name=t,this.parent=i,this.children=n,this.unfold=!1}static fromServerData(e){return function e(t,i){const s=new r(t.path,t.name,i),o=t.children.sort(((e,t)=>e.sortIndex-t.sortIndex));return s.children=o.map((t=>"file"===t.type?new n.FileObject(t.path,t.name,s):"directory"===t.type?e(t,s):void 0)),s}(e,null)}}t.Directory=r},660:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileObject=void 0,t.FileObject=class{constructor(e,t,i,n,r){this.path=e,this.name=t,this.parent=i,this.headRenderNode=n,this.ast=r,this.transDuaration=10,this.count=0,this.lastTime=null,this.resolveFn=null,this.getNewCodePromise=null,this.currentNode=null,this.content=null,this.dirty=!0}static stringify(e,t){let i="",n=e;for(;n&&(i+=n.text.replace(/\&nbsp;/g," "),n.lineEnd&&(i+="\r\n"),n.id!==t.id);)n=n.nextNode;return i}scheduleTrans(){setTimeout((()=>{this.count=0,this.lastTime=Date.now(),this.doTrans()}))}isNeedBreak(){return Date.now()-this.lastTime>this.transDuaration}doTrans(){for(this.currentNode||(this.currentNode=this.headRenderNode);this.currentNode;){if(this.content+=this.currentNode.text.replace(/\&nbsp;/g," "),this.currentNode.lineEnd&&(this.content+="\r\n"),this.currentNode=this.currentNode.nextNode,this.currentNode===this.headRenderNode)return void this.finishTrans();if(this.count++,this.count>=100&&this.isNeedBreak()){this.scheduleTrans();break}}}finishTrans(){this.resolveFn(this.content),this.lastTime=this.resolveFn=this.currentNode=null,this.count=0}setIsDirty(){this.dirty=!0}isDirty(){return this.dirty}stringifyAsyn(){return this.dirty&&(this.dirty=!1,this.getNewCodePromise=new Promise((e=>this.resolveFn=e)),this.content="",this.scheduleTrans()),this.getNewCodePromise}}},3640:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperationMenu=void 0;const n=i(7294);i(3079);class r extends n.Component{constructor(e){super(e)}gOperationEles(){return this.props.operations?this.props.operations.map((e=>n.createElement("li",{onClick:()=>e.onClick()},n.createElement("i",{className:e.iconClass}),n.createElement("span",null,e.name),n.createElement("span",{className:"short-cut"},e.shortCut)))):[]}render(){return n.createElement("div",{className:"tran-full-screen-cover operation-menu",onClick:e=>{var t;e.stopPropagation(),null===(t=this.props)||void 0===t||t.onCoverClick()},onMouseDown:e=>{e.stopPropagation()},onMouseUp:e=>{e.stopPropagation()}},n.createElement("div",{className:"menu-container",onClick:e=>{e.stopPropagation()},style:{left:this.props.menuPosition.left+"px",top:this.props.menuPosition.top+"px"}},n.createElement("ul",null,this.gOperationEles())))}}t.OperationMenu=r},2629:(e,t,i)=>{const n=i(3935),r=i(7294);i(1750);const s=i(6646);window.oncontextmenu=e=>!1,n.render(r.createElement(s.App,null),document.getElementById("app"))},2274:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MyContext=void 0;const n=i(7294);t.MyContext=n.createContext("default value")},8125:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ENWRAP_CLOSE_MAP=t.ENWRAP_OPEN=void 0,t.ENWRAP_OPEN=["(","{","[","'",'"'],t.ENWRAP_CLOSE_MAP={"(":")","{":"}","[":"]","'":"'",'"':'"'}},650:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MergeCall=void 0,t.MergeCall=function(e=100){return function(t,i,n){let r=t[i],s=null;n.value=function(...t){s&&clearTimeout(s),s=setTimeout((()=>{r.apply(this,t)}),e)}}}},5285:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0;const n=i(5337),r=i(7338),s=i(410),o=i(4353);class a{static measureCharLen(e){let t=0;for(let i=0,n=e.length;i<n;i++)e.charCodeAt(i)>255?t+=a.charSize2:t+=a.charSize;return t}static getCharLenFromRowHead(e,t){const i=a.getLineStart(e);let n=0;return a.nodeLinkedListUntil.find(i,(e=>{if(e.text.length+e.col>=t)return n+=a.measureCharLen(e.text.slice(0,t-e.col)),!0;n+=a.measureCharLen(e.text)})),n}static getRowIndent(e){let t,i=0,n=/[^ ]+/,r=a.getLineStart(e);for(;!(t=n.exec(r.text))&&!r.isHead&&(i+=r.text.length,!r.lineEnd);)r=r.nextNode;return t&&(i+=t.index),i}static getCharSizeFromRowHead(e){let t=a.getLineStart(e),i=0;return a.nodeLinkedListUntil.forEach(t,(e=>{i+=a.measureSizeOfText(e.text)}),e.prevNode),i}static measureSizeOfText(e){let t=0;for(let i=0;i<e.length;i++)t+=e.charCodeAt(i)>255?2:1;return t}static measureOffset(e,t){let i=0,n=0;for(let r=0,s=t.length;r<s;r++){if(t.charCodeAt(r)>255?i+=a.charSize2:i+=a.charSize,i===e)return++n;if(i>e)return n;n++}return n}static matchPosition(e,t,i=!1){let n=0,r=e,s=0;e:do{let e=r.text;for(let r=0,o=e.length;r<o;r++){let o=n;if(s++,e.charCodeAt(r)>255?n+=a.charSize2:n+=a.charSize,n===t)break e;if(n>t){i||(n=o,s--);break e}}if(r.lineEnd)break;r=r.nextNode}while(r!==e);return{node:r,col:s,charLen:n}}static cloneCodeRenderNode(e){return r.CodeRenderNodeUtil.cloneNode(e)}static cloneSelection(e){return{from:Object.assign({},e.from),to:Object.assign({},e.to),direction:e.direction}}static cloneAndUpdateRenderNode(e,t){let i=new n.CodeRenderNode,r=i.id;return Object.assign(i,e,t||{}),i.id=r,i}static isSamePos(e,t){return e.row===t.row&&e.col===t.col}static getLineStartSpace(e){let t="";return a.nodeLinkedListUntil.find(a.getLineStart(e),(e=>{if(32!==e.text.charCodeAt(0))return!0;let i=e.text.match(/[^ ]/);return t+=i?e.text.slice(0,i.index):e.text,!!e.lineEnd||void 0})),t}static getLineStart(e){let t;return a.nodeLinkedListUntil.findReversely(e.prevNode,(e=>e.lineEnd?(t=e.nextNode,!0):e.block?void 0:(t=e.nextNode,!0))),t}static getLastEnd(e){return e&&a.nodeLinkedListUntil.findReversely(e.prevNode,(e=>e.lineEnd))||null}static getNextStart(e){return a.nodeLinkedListUntil.find(e,(e=>e.lineEnd)).nextNode}static isPositionGreater(e,t){return t.row>e.row||!(t.row<e.row)&&t.col>e.col}static isPositionSmaller(e,t){return t.row<e.row||!(t.row>e.row)&&(t.col<e.col||void 0)}static MatchDefinition(e){return function e(t,i,n,r=0){let s;if(i&&t.prevNode.identifier?s=e(t.prevNode,!1,!0,r+1):n&&"."===t.prevNode.text&&(s=e(t.prevNode,!0,!1,r+1)),s)return 0===r?t.identifier?s.definitions?o.Scope.prototype.matchOwnDefinitions.call(s,t.text):null:s.definitions.map((e=>({near:0,definition:e,index:0,text:e.identifier,textLeft:"",textRight:""}))):t.identifier?s.definitions?s.definitions.find((e=>e.identifier===t.text)):null:s;let a=t.scope();return 0===r?a.matchDefinitions(t.text):a.fullMatchDefinition(t.text)}(e,"."===e.text,e.identifier)}static sortDefinitions(e){return e.sort(((e,t)=>e.index===t.index?e.near-t.near:e.index-t.index))}static insertText(e,t,i){return e.slice(0,t)+i+e.slice(t)}static showUpSpace(e,t=0,i){var n,r,s;const o=/(\s+)/;i=null!=i?i:e.text.length;let a,l=e.text.slice(t,i),d=[];for(t>0&&d.push({text:e.text.slice(0,t),style:{color:null===(n=e.style)||void 0===n?void 0:n.color}});a=l.match(o);)0!==a.index&&d.push({text:l.slice(0,a.index),style:e.style}),d.push({text:a[1].replace(/\s/g,"·"),style:{color:"rgba(101,101,101,0.5)"}}),l=l.slice(a.index+a[1].length);return l&&d.push({text:l,style:{color:null===(r=e.style)||void 0===r?void 0:r.color}}),i<e.text.length&&d.push({text:e.text.slice(i),style:{color:null===(s=e.style)||void 0===s?void 0:s.color}}),d}static getIndexs(e,t,i){let n=a.boundaryLinkedListUtil.find(e,(e=>!!e.node),t);if(!n)return{startIndex:null,endIndex:null};let r=a.boundaryLinkedListUtil.findReversely(t,(e=>!!e.node),e);return{startIndex:i.findIndex((e=>n.node)),endIndex:i.findIndex((e=>r.node))}}static riseToSameBlock(e,t){e=a.nodeLinkedListUntil.findReversely(e,(e=>{var t;return!e.err&&(null===(t=e.text)||void 0===t?void 0:t.length)||e.prevNode.isHead||e.isHead})),t=a.nodeLinkedListUntil.find(t,(e=>{var t;return!e.err&&(null===(t=e.text)||void 0===t?void 0:t.length)||e.nextNode.isHead||e.isHead}));let i=e.boundary,n=t.isHead?t.boundary:t.boundary.nextBoundary,r=i.nextNode,s=n.prevNode;for(;r.block!==s.block;)r.block.depth>s.block.depth?a.boundaryLinkedListUtil.findReversely(i,(e=>{var t,n;if(((null===(t=e.nextNode.block)||void 0===t?void 0:t.depth)||0)<((null===(n=r.block)||void 0===n?void 0:n.depth)||0))return i=e,r=e.nextNode,!0})):a.boundaryLinkedListUtil.find(n,(e=>{var t,i;if(((null===(t=e.prevNode.block)||void 0===t?void 0:t.depth)||0)<((null===(i=s.block)||void 0===i?void 0:i.depth)||0))return n=e,s=e.prevNode,!0}));return{curLeftNode:r,curRightNode:s,curLeftBoundary:i,curRightBoundary:n}}}t.Util=a,a.charSize=69.28/7,a.charSize2=18.000634920634923,a.nodeLinkedListUntil=new s.LinkedListUtil("prevNode","nextNode"),a.boundaryLinkedListUtil=new s.LinkedListUtil("prevBoundary","nextBoundary"),a.identifierLinkedListUtil=new s.LinkedListUtil("prevIdentifier","nextIdentifier"),a.breakPoints=[" ","+","-","*","/","="]},9182:(e,t,i)=>{i.r(t),i.d(t,{Config:()=>n});const n={SERVER_URL:"http://47.104.67.88:8888"}}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var s=i[e]={id:e,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,i,r,s)=>{if(!i){var o=1/0;for(d=0;d<e.length;d++){for(var[i,r,s]=e[d],a=!0,l=0;l<i.length;l++)(!1&s||o>=s)&&Object.keys(n.O).every((e=>n.O[e](i[l])))?i.splice(l--,1):(a=!1,s<o&&(o=s));a&&(e.splice(d--,1),t=r())}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[i,r,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,i)=>{var r,s,[o,a,l]=i,d=0;for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)var c=l(n);for(t&&t(i);d<o.length;d++)s=o[d],n.o(e,s)&&e[s]&&e[s][0](),e[o[d]]=0;return n.O(c)},i=self.webpackChunkcloud_code=self.webpackChunkcloud_code||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=n.O(void 0,[373],(()=>n(2629)));r=n.O(r)})();